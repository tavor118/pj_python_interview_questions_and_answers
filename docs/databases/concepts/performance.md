## Продуктивність

### Як виявити повільний SQL запит?

- Логування повільних запитів  - У багатьох СУБД є можливість увімкнути логування повільних запитів. Наприклад, у MySQL можна налаштувати параметри `slow_query_log` та `long_query_time`, щоб записувати запити, які виконуються довше за заданий час.
- Профілювання запитів  - Використання інструментів, які надають детальну інформацію про виконання запиту. У PostgreSQL команда `EXPLAIN` або `EXPLAIN ANALYZE` дозволяє побачити план виконання запиту, оцінити використання індексів, кількість зчитувань та час виконання.
- Інструменти моніторингу СУБД  - Використання спеціалізованих інструментів, таких як `pg_stat_statements` у PostgreSQL або Performance Schema у MySQL, які відстежують та агрегують інформацію про виконувані запити.
- Імітація навантаження  - Використання інструментів для створення штучного навантаження (наприклад, Apache JMeter) дозволяє оцінити поведінку запитів у реальних умовах.


### Що таке профілювання запитів?

Профілювання запитів - це процес аналізу та оптимізації виконання запитів до бази даних.

Під час профілювання запитів, ви використовується "EXPLAIN", щоб отримати план виконання запиту. Цей план показує, як база даних обробляє запит, включаючи послідовність операцій та використані ресурси.

"EXPLAIN" допомагає ідентифікувати можливі "гарячі точки" в запиті. Це дає змогу розробникам виявити слабкі місця та можливість їх виправити, наприклад створити або оптимізувати індекс, переписати запит або змінити налаштування бази даних.


### Що таке Deadlock? Як їх уникати?

**Deadlock (взаємоблокування)** — це ситуація, коли дві або більше транзакції блокують одна одну, очікуючи на ресурси, які вже заблоковані іншими транзакціями. У такому стані транзакції не можуть завершитися, доки не буде втручання ззовні.

Дедлок може виникати, коли дві транзакції блокують одні й ті ж ресурси, але в різному порядку. Наприклад, одна транзакція блокує таблицю `A` і чекає таблицю `B`, тоді як інша транзакція блокує `B` і чекає `A`.

Можливі варіанти для уникнення Deadlock

- **Зменшення часу утримання блокувань**  - Мінімізація кількіості операцій між початком транзакції (`BEGIN`) і її завершенням (`COMMIT` або `ROLLBACK`).
- **Використання рівнів ізоляції**  - Вибір відповідного рівня ізоляції (наприклад, `READ COMMITTED`) може зменшити ймовірність виникнення взаємоблокувань.
- **Розбиття великих транзакцій**  - Якщо можливо, розбити великі транзакції на менші, щоб зменшити ризик блокування ресурсів.
- **Використання таймаутів для блокувань** - Налаштування таймауту дозволяє уникнути затяжного очікування у випадку Deadlock. У PostgreSQL, наприклад, це параметр `lock_timeout`.

