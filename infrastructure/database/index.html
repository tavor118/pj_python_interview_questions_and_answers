<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=Andrew><link href=https://tavor118.github.io/python-questions-and-answers/infrastructure/database/ rel=canonical><link href=../sql/ rel=prev><link href=../mq/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>Database - Python Questions and Answers</title><link rel=stylesheet href=../../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../stylesheets/links.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#database class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Python Questions and Answers" class="md-header__button md-logo" aria-label="Python Questions and Answers" data-md-component=logo> <img src=../../img/logo.bmp alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Python Questions and Answers </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Database </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/tavor118/pj_python_interview_questions_and_answers title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> tavor118/pj_python_interview_questions_and_answers </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Python Questions and Answers" class="md-nav__button md-logo" aria-label="Python Questions and Answers" data-md-component=logo> <img src=../../img/logo.bmp alt=logo> </a> Python Questions and Answers </label> <div class=md-nav__source> <a href=https://github.com/tavor118/pj_python_interview_questions_and_answers title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> tavor118/pj_python_interview_questions_and_answers </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../python/ class="md-nav__link "> <span class=md-ellipsis> Python </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python/general/ class=md-nav__link> <span class=md-ellipsis> General </span> </a> </li> <li class=md-nav__item> <a href=../../python/syntax/ class=md-nav__link> <span class=md-ellipsis> Syntax </span> </a> </li> <li class=md-nav__item> <a href=../../python/data_types/ class=md-nav__link> <span class=md-ellipsis> Data Types </span> </a> </li> <li class=md-nav__item> <a href=../../python/sequences/ class=md-nav__link> <span class=md-ellipsis> Sequences </span> </a> </li> <li class=md-nav__item> <a href=../../python/set_and_dict/ class=md-nav__link> <span class=md-ellipsis> Set and Dict </span> </a> </li> <li class=md-nav__item> <a href=../../python/loops/ class=md-nav__link> <span class=md-ellipsis> Loops </span> </a> </li> <li class=md-nav__item> <a href=../../python/functions/ class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> <li class=md-nav__item> <a href=../../python/decorators/ class=md-nav__link> <span class=md-ellipsis> Decorators </span> </a> </li> <li class=md-nav__item> <a href=../../python/iterator_and_generator/ class=md-nav__link> <span class=md-ellipsis> Iterator and Generator </span> </a> </li> <li class=md-nav__item> <a href=../../python/class_and_object/ class=md-nav__link> <span class=md-ellipsis> Class and Object </span> </a> </li> <li class=md-nav__item> <a href=../../python/metaclass/ class=md-nav__link> <span class=md-ellipsis> Metaclass </span> </a> </li> <li class=md-nav__item> <a href=../../python/namespace_and_context_manager/ class=md-nav__link> <span class=md-ellipsis> Namespace and Context Manager </span> </a> </li> <li class=md-nav__item> <a href=../../python/modules_and_packets/ class=md-nav__link> <span class=md-ellipsis> Modules and Packets </span> </a> </li> <li class=md-nav__item> <a href=../../python/exceptions/ class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> <li class=md-nav__item> <a href=../../python/files_and_io/ class=md-nav__link> <span class=md-ellipsis> Files and IO </span> </a> </li> <li class=md-nav__item> <a href=../../python/async/ class=md-nav__link> <span class=md-ellipsis> Async </span> </a> </li> <li class=md-nav__item> <a href=../../python/gil_threads_processes/ class=md-nav__link> <span class=md-ellipsis> GIL Threads Processes </span> </a> </li> <li class=md-nav__item> <a href=../../python/interpreter/ class=md-nav__link> <span class=md-ellipsis> Interpreter </span> </a> </li> <li class=md-nav__item> <a href=../../python/functional_programming/ class=md-nav__link> <span class=md-ellipsis> Functional Programming </span> </a> </li> <li class=md-nav__item> <a href=../../python/standard_library/ class=md-nav__link> <span class=md-ellipsis> Standard Library </span> </a> </li> <li class=md-nav__item> <a href=../../python/python_packages/ class=md-nav__link> <span class=md-ellipsis> Python Packages </span> </a> </li> <li class=md-nav__item> <a href=../../python/coding/ class=md-nav__link> <span class=md-ellipsis> Coding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../python_framework/ class="md-nav__link "> <span class=md-ellipsis> Python Framework </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Python Framework </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python_framework/django/ class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=../../python_framework/drf/ class=md-nav__link> <span class=md-ellipsis> DRF </span> </a> </li> <li class=md-nav__item> <a href=../../python_framework/fast_api/ class=md-nav__link> <span class=md-ellipsis> Fast API </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../computer_science/ class="md-nav__link "> <span class=md-ellipsis> Computer Science </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Computer Science </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer_science/oop/ class=md-nav__link> <span class=md-ellipsis> OOP </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/programming_principles/ class=md-nav__link> <span class=md-ellipsis> Programming Principles </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/solid/ class=md-nav__link> <span class=md-ellipsis> SOLID </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/data_structures/ class=md-nav__link> <span class=md-ellipsis> Data Structures </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/algorithmes/ class=md-nav__link> <span class=md-ellipsis> Algorithms </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/computer_science/ class=md-nav__link> <span class=md-ellipsis> Computer Science </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/testing/ class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../web_development/ class="md-nav__link "> <span class=md-ellipsis> Web Development </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Web Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../web_development/http/ class=md-nav__link> <span class=md-ellipsis> HTTP </span> </a> </li> <li class=md-nav__item> <a href=../../web_development/rest_soap/ class=md-nav__link> <span class=md-ellipsis> REST SOAP </span> </a> </li> <li class=md-nav__item> <a href=../../web_development/rpc/ class=md-nav__link> <span class=md-ellipsis> RPC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Infrastructure </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sql/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Database </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#database class=md-nav__link> <span class=md-ellipsis> Database </span> </a> <nav class=md-nav aria-label=Database> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> Що таке бази даних і для чого вони потрібні? </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> Які типи баз даних існують? </span> </a> </li> <li class=md-nav__item> <a href=#nosql class=md-nav__link> <span class=md-ellipsis> Чим Реляційні БД відрізняються від NoSQL БД? </span> </a> </li> <li class=md-nav__item> <a href=#rdb-nosql class=md-nav__link> <span class=md-ellipsis> Застосування RDB (реляційних баз даних) та NoSQL </span> </a> </li> <li class=md-nav__item> <a href=#nosql_1 class=md-nav__link> <span class=md-ellipsis> Наведіть приклади РБД та NoSQL БД </span> </a> </li> <li class=md-nav__item> <a href=#base-acid class=md-nav__link> <span class=md-ellipsis> Яка різниця між BASE і ACID? </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> Яку базу даних використовувати у проекті? </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-mysql class=md-nav__link> <span class=md-ellipsis> Яка різниця між PostgreSQL і MySQL </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> Які типи зв'язків бувають в БД? </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> Що таке індекси? Навіщо вони потрібні? Як вони працюють? </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> Які популярні типи індексів існують? </span> </a> </li> <li class=md-nav__item> <a href=#uuid class=md-nav__link> <span class=md-ellipsis> UUID </span> </a> </li> <li class=md-nav__item> <a href=#create-index-concurrently class=md-nav__link> <span class=md-ellipsis> В яких випадках використовується CREATE INDEX CONCURRENTLY </span> </a> </li> <li class=md-nav__item> <a href=#seq-scan class=md-nav__link> <span class=md-ellipsis> Що таке seq-scan? Коли він виконується, навіть якщо є індекси? </span> </a> </li> <li class=md-nav__item> <a href=#acid class=md-nav__link> <span class=md-ellipsis> Що таке транзакція? Що таке ACID? </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> Які команди управління транзакціями ви знаєте </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> Що таке рівні ізоляції транзакцій. Які вони бувають </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> Вкладені транзакції </span> </a> </li> <li class=md-nav__item> <a href=#wal class=md-nav__link> <span class=md-ellipsis> Що таке WAL? </span> </a> </li> <li class=md-nav__item> <a href=#mvcc class=md-nav__link> <span class=md-ellipsis> Що таке MVCC? </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> Що таке тригери? </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> Що таке курсор і навіщо він потрібен </span> </a> </li> <li class=md-nav__item> <a href=#vacuum-postgresql class=md-nav__link> <span class=md-ellipsis> Що таке VACUUM в PostgreSQL </span> </a> </li> <li class=md-nav__item> <a href=#sql class=md-nav__link> <span class=md-ellipsis> Як виявити повільний SQL запит? </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> Що таке профілювання запитів? </span> </a> </li> <li class=md-nav__item> <a href=#deadlock class=md-nav__link> <span class=md-ellipsis> Що таке Deadlock? Як їх уникати? </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> Нормалізація баз даних </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> Партиціювання та шардування </span> </a> </li> <li class=md-nav__item> <a href=#master-slave class=md-nav__link> <span class=md-ellipsis> Master-Slave </span> </a> </li> <li class=md-nav__item> <a href=#oltp-olap class=md-nav__link> <span class=md-ellipsis> Яка різниця між OLTP та OLAP? </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> Сесія, курсор </span> </a> </li> <li class=md-nav__item> <a href=#pgbouncer class=md-nav__link> <span class=md-ellipsis> Пул з'єднань, PgBouncer </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../mq/ class=md-nav__link> <span class=md-ellipsis> MQ </span> </a> </li> <li class=md-nav__item> <a href=../docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> <li class=md-nav__item> <a href=../kubernates/ class=md-nav__link> <span class=md-ellipsis> Kubernates </span> </a> </li> <li class=md-nav__item> <a href=../server/ class=md-nav__link> <span class=md-ellipsis> Server </span> </a> </li> <li class=md-nav__item> <a href=../aws/ class=md-nav__link> <span class=md-ellipsis> AWS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../architecture/ class="md-nav__link "> <span class=md-ellipsis> Architecture </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/architecture_patterns/ class=md-nav__link> <span class=md-ellipsis> Architecture Patterns </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/ddd/ class=md-nav__link> <span class=md-ellipsis> DDD </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/system_design/ class=md-nav__link> <span class=md-ellipsis> System Design </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../../development/ class="md-nav__link "> <span class=md-ellipsis> Development </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/git/ class=md-nav__link> <span class=md-ellipsis> Git </span> </a> </li> <li class=md-nav__item> <a href=../../development/ci_cd/ class=md-nav__link> <span class=md-ellipsis> CI/CD </span> </a> </li> <li class=md-nav__item> <a href=../../development/sdlc/ class=md-nav__link> <span class=md-ellipsis> SDLC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../../frontend/ class="md-nav__link "> <span class=md-ellipsis> Front-end </span> </a> <label class="md-nav__link " for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Front-end </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../frontend/front_end/ class=md-nav__link> <span class=md-ellipsis> Front End </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/javascript/ class=md-nav__link> <span class=md-ellipsis> JavaScript </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/dom/ class=md-nav__link> <span class=md-ellipsis> DOM </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/framework/ class=md-nav__link> <span class=md-ellipsis> Framework </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/html/ class=md-nav__link> <span class=md-ellipsis> HTML </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/css/ class=md-nav__link> <span class=md-ellipsis> CSS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#database class=md-nav__link> <span class=md-ellipsis> Database </span> </a> <nav class=md-nav aria-label=Database> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> Що таке бази даних і для чого вони потрібні? </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> Які типи баз даних існують? </span> </a> </li> <li class=md-nav__item> <a href=#nosql class=md-nav__link> <span class=md-ellipsis> Чим Реляційні БД відрізняються від NoSQL БД? </span> </a> </li> <li class=md-nav__item> <a href=#rdb-nosql class=md-nav__link> <span class=md-ellipsis> Застосування RDB (реляційних баз даних) та NoSQL </span> </a> </li> <li class=md-nav__item> <a href=#nosql_1 class=md-nav__link> <span class=md-ellipsis> Наведіть приклади РБД та NoSQL БД </span> </a> </li> <li class=md-nav__item> <a href=#base-acid class=md-nav__link> <span class=md-ellipsis> Яка різниця між BASE і ACID? </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> Яку базу даних використовувати у проекті? </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-mysql class=md-nav__link> <span class=md-ellipsis> Яка різниця між PostgreSQL і MySQL </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> Які типи зв'язків бувають в БД? </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> Що таке індекси? Навіщо вони потрібні? Як вони працюють? </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> Які популярні типи індексів існують? </span> </a> </li> <li class=md-nav__item> <a href=#uuid class=md-nav__link> <span class=md-ellipsis> UUID </span> </a> </li> <li class=md-nav__item> <a href=#create-index-concurrently class=md-nav__link> <span class=md-ellipsis> В яких випадках використовується CREATE INDEX CONCURRENTLY </span> </a> </li> <li class=md-nav__item> <a href=#seq-scan class=md-nav__link> <span class=md-ellipsis> Що таке seq-scan? Коли він виконується, навіть якщо є індекси? </span> </a> </li> <li class=md-nav__item> <a href=#acid class=md-nav__link> <span class=md-ellipsis> Що таке транзакція? Що таке ACID? </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> Які команди управління транзакціями ви знаєте </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> Що таке рівні ізоляції транзакцій. Які вони бувають </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> Вкладені транзакції </span> </a> </li> <li class=md-nav__item> <a href=#wal class=md-nav__link> <span class=md-ellipsis> Що таке WAL? </span> </a> </li> <li class=md-nav__item> <a href=#mvcc class=md-nav__link> <span class=md-ellipsis> Що таке MVCC? </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> Що таке тригери? </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> Що таке курсор і навіщо він потрібен </span> </a> </li> <li class=md-nav__item> <a href=#vacuum-postgresql class=md-nav__link> <span class=md-ellipsis> Що таке VACUUM в PostgreSQL </span> </a> </li> <li class=md-nav__item> <a href=#sql class=md-nav__link> <span class=md-ellipsis> Як виявити повільний SQL запит? </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> Що таке профілювання запитів? </span> </a> </li> <li class=md-nav__item> <a href=#deadlock class=md-nav__link> <span class=md-ellipsis> Що таке Deadlock? Як їх уникати? </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> Нормалізація баз даних </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> Партиціювання та шардування </span> </a> </li> <li class=md-nav__item> <a href=#master-slave class=md-nav__link> <span class=md-ellipsis> Master-Slave </span> </a> </li> <li class=md-nav__item> <a href=#oltp-olap class=md-nav__link> <span class=md-ellipsis> Яка різниця між OLTP та OLAP? </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> Сесія, курсор </span> </a> </li> <li class=md-nav__item> <a href=#pgbouncer class=md-nav__link> <span class=md-ellipsis> Пул з'єднань, PgBouncer </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Database</h1> <h3 id=database>Database<a class=headerlink href=#database title="Permanent link">⚑</a></h3> <h4 id=_1>Що таке бази даних і для чого вони потрібні?<a class=headerlink href=#_1 title="Permanent link">⚑</a></h4> <p>База даних - це організована структура для зберігання та управління інформацією. Вона дозволяє зберігати, організовувати, шукати та забезпечувати доступ до даних з різних джерел та для різних цілей.</p> <p>Під базою даних зазвичай розуміють систему керування базами даних. Але варто розрізняти базу даних — сховище даних, та СКБД — засоби для роботи з базою даних.</p> <p>Бази даних служать для</p> <ul> <li>Збереження різноманітних даних, які можуть бути структурованими.</li> <li>Організації даних у логічних структурах, таких як таблиці, колекції ключ-значення.</li> <li>Забезпечення швидкого доступу до даних через індекси та оптимізовані запити.</li> <li>Забезпечення безпеки даних шляхом управління правами доступу.</li> <li>Можливості спільної роботи над даними багатьох користувачів.</li> <li>Виконання аналітичних завдань та генерація звітів.</li> </ul> <h4 id=_2>Які типи баз даних існують?<a class=headerlink href=#_2 title="Permanent link">⚑</a></h4> <ul> <li><strong>Реляційні бази даних (РБД):</strong> Цей тип баз даних використовує таблиці для зберігання даних, де кожен рядок представляє запис, а кожна колонка - поле даних. Такі бази даних добре підходять для зберігання структурованих даних та встановлення зв'язків між ними.</li> <li><strong>Документ-орієнтовані бази даних:</strong> Вони зберігають дані у вигляді документів, таких як JSON або XML. Це корисно для зберігання неструктурованих даних або даних зі змінними полями.</li> <li><strong>Ключ-значення бази даних:</strong> Вони працюють на основі структури ключ-значення, де кожен запис зберігається за унікальним ключем. Це дозволяє швидко вибирати та зберігати дані.</li> <li><strong>Стовпчикові бази даних:</strong> Вони організовані за стовпцями, що допомагає оптимізувати запити на вибірку конкретних полів даних.</li> <li><strong>Графові бази даних:</strong> Вони засновані на графовій структурі, де дані представлені як вузли та зв'язки між ними. Такий підхід зручний для аналізу зв'язків та взаємодій.</li> </ul> <h4 id=nosql>Чим Реляційні БД відрізняються від NoSQL БД?<a class=headerlink href=#nosql title="Permanent link">⚑</a></h4> <p>Реляційні бази даних (РБД) та нереляційні бази даних (NoSQL) відрізняються за своєю структурою, способом зберігання та обробки даних.</p> <ul> <li>Схема даних</li> <li>РБД: Використовують жорстку, попередньо визначену схему даних з таблицями, колонками і типами даних, з визначеними відношеннями між ними.</li> <li> <p>NoSQL БД: Забезпечують гнучку схему даних, що дозволяє зберігати дані різного типу без жорсткої фіксованої структури.</p> </li> <li> <p>Масштабованість</p> </li> <li>РБД: Масштабування може бути складнішим, особливо при горизонтальному масштабуванні.</li> <li> <p>NoSQL БД: Зазвичай пропонують легше горизонтальне масштабування завдяки спеціалізованій архітектурі.</p> </li> <li> <p>Запити</p> </li> <li>РБД: Використовують мову запитів SQL для взаємодії з даними.</li> <li> <p>NoSQL БД: Використовують різні мови запитів або інтерфейси для операцій з даними.</p> </li> <li> <p>Транзакції та консистентність</p> </li> <li>РБД: Забезпечують гарантії ACID для збереження цілісності даних.</li> <li>NoSQL БД: Можуть пропонувати менш жорсткі гарантії цілісності, забезпечуючи вищу швидкість та масштабованість.</li> </ul> <h4 id=rdb-nosql>Застосування RDB (реляційних баз даних) та NoSQL<a class=headerlink href=#rdb-nosql title="Permanent link">⚑</a></h4> <p>Застосування RDB (реляційних баз даних) та NoSQL баз даних залежить від конкретних вимог проекту та характеристик даних.</p> <p>Коли краще використовувати RDB</p> <ul> <li>Структуровані дані<ul> <li>Якщо дані мають чітку структуру з фіксованими схемами і повинні відповідати певним типам даних.</li> </ul> </li> <li>Зв'язки між даними<ul> <li>Для проектів, де потрібні складні зв'язки між таблицями та забезпечення цілісності даних за допомогою зовнішніх ключів.</li> </ul> </li> <li>Транзакції<ul> <li>У випадках, коли важлива підтримка транзакцій ACID (атомарність, узгодженість, ізольованість, надійність) для забезпечення надійності операцій з даними.</li> </ul> </li> <li>Складні запити<ul> <li>Коли необхідно виконувати складні SQL-запити, такі як об'єднання таблиць (JOIN), агрегації та фільтрації даних.</li> </ul> </li> </ul> <p>Типові застосування — фінансові системи, системи обліку, ERP, де важливий цілісний і послідовний стан даних.</p> <p>Коли краще використовувати NoSQL</p> <ul> <li>Гнучкість схем<ul> <li>Якщо структура даних може змінюватися з часом і потрібна гнучкість у зміні схем без складних міграцій.</li> </ul> </li> <li>Великі обсяги даних<ul> <li>Для проектів, де необхідно зберігати та обробляти великі обсяги даних, особливо неструктурованих або напівструктурованих (наприклад, документи, JSON, графи)</li> </ul> </li> <li>Висока продуктивність і масштабованість<ul> <li>У випадках, коли потрібна висока продуктивність записів і читання даних, а також горизонтальне масштабування для розподілених систем.</li> </ul> </li> <li>Великі дані та аналітика<ul> <li>Для проектів, які потребують аналізу великих даних у реальному часі, таких як потоки подій, журнали, соціальні мережі.</li> </ul> </li> <li>Кешування<ul> <li>Коли потрібно швидко отримати доступ до даних, кешування даних за допомогою NoSQL може забезпечити швидший доступ до даних, ніж реляційна база даних.</li> </ul> </li> </ul> <p>NoSQL також часто використовують у високонавантажених системах, таких як соціальні мережі, аналітичні платформи, логування, системи реального часу.</p> <h4 id=nosql_1>Наведіть приклади РБД та NoSQL БД<a class=headerlink href=#nosql_1 title="Permanent link">⚑</a></h4> <p>Приклади реляційних баз даних (РБД)</p> <ul> <li>MySQL</li> <li>PostgreSQL</li> <li>Microsoft SQL Server</li> <li>Oracle Database</li> <li>SQLite</li> </ul> <p>Приклади баз даних типу NoSQL</p> <ul> <li>MongoDB<ul> <li>Орієнтована на документи NoSQL база даних, яка зберігає дані у вигляді документів (наприклад, JSON) з гнучкою схемою.</li> <li>MongoDB легко масштабується горизонтально та підтримує індексування даних, що забезпечує швидкий доступ до них.</li> <li>Для зберігання інформації використовується тип даних BSON (Binary JSON). BSON – це бінарний формат для представлення JSON-подібних документів. BSON забезпечує більш ефективне зберігання даних, ніж JSON.</li> </ul> </li> <li>Cassandra<ul> <li>Ключ-значення база даних, яка підходить для великих обсягів даних та горизонтального масштабування.</li> </ul> </li> <li>Redis (REmote DIctionary Server) <ul> <li>Швидка база даних типу ключ-значення, яка використовується для кешування та зберігання швидкозмінних даних.</li> <li>Redis швидко обробляє дані завдяки тому, що всі дані зберігаються у пам'яті.</li> </ul> </li> </ul> <h4 id=base-acid>Яка різниця між BASE і ACID?<a class=headerlink href=#base-acid title="Permanent link">⚑</a></h4> <p><strong>BASE:</strong> Це підхід до дизайну систем управління базами даних, який ставить акцент на доступність та швидкодію. BASE розшифровується як "Basically Available, Soft state, Eventually consistent" (базова доступність, нестійкий стан, консистентна в кінцевому рахунку).</p> <ul> <li>Під базовою доступністю розуміється такий підхід до проектування додатка, за якого збій в деяких вузлах призводить до відмови в обслуговуванні лише для незначної частини сеансів, зі збереженням доступності в більшості випадків. </li> <li>Нестійкий стан передбачає можливість пожертвувати довгостроковим зберіганням стану сеансів (такого як проміжні результати виборок, інформація про навігацію, контекст), зосереджуючись при цьому на фіксації оновлень лише критичних операцій. </li> <li>Узгодженість у кінцевому підсумку, яка трактується як можливість суперечливості даних у деяких випадках, але за умови забезпечення узгодженості протягом практично прийнятного часу. </li> </ul> <p>Таким чином, згідно з підходом BASE, система може тимчасово допускати неузгодженість даних для забезпечення високої доступності та швидкості в операціях. Це особливо важливо в розподілених системах, де збереження строгої консистентності може призвести до затримок.</p> <p><strong>ACID:</strong> Це набір властивостей, які визначають надійність транзакцій у системах управління базами даних. ACID розшифровується як "Atomicity, Consistency, Isolation, Durability" (Атомарність, Цілісність, Ізоляція, Довговічність). Ці властивості гарантують, що транзакції виконуються надійно: вони атомарні (або повністю виконуються або взагалі не виконуються), зберігають цілісність даних, ізолюються одна від одної та є стійкими до відмов.</p> <p>Отже, різниця полягає в підході: ACID надає пріоритет стабільності, цілісності та гарантії цілісності даних, тоді як BASE більше акцентується на доступності, швидкості та готовності системи працювати навіть за умови відмов.</p> <h4 id=_3>Яку базу даних використовувати у проекті?<a class=headerlink href=#_3 title="Permanent link">⚑</a></h4> <p>Якщо структура даних має складні зв'язки і треба виконувати складні SQL-запити з багатьма джоінами, краще вибрати реляційну базу даних, таку як PostgreSQL або MySQL.</p> <p>Якщо ж треба працювати з великим обсягом неструктурованих або змінюваних даних, краще вибрати NoSQL. MongoDB добре підходить для сховища документів, а Redis чи Cassandra - для швидкого зберігання та доступу до даних типу key-value.</p> <p>Іншим важливим критерієм є масштабованість. NoSQL бази даних зазвичай дозволяють легше масштабувати систему горизонтально, додавши нові вузли при зростанні обсягу даних</p> <p><em>Links</em></p> <ul> <li><a href=https://medium.com/nuances-of-programming/%D0%BA%D0%B0%D0%BA-%D0%B2%D1%8B%D0%B1%D1%80%D0%B0%D1%82%D1%8C-%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D1%8C%D0%BD%D1%83%D1%8E-%D0%B1%D0%B0%D0%B7%D1%83-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-62b0747f7f47>Выбираем базу данных</a></li> </ul> <h4 id=postgresql-mysql>Яка різниця між PostgreSQL і MySQL<a class=headerlink href=#postgresql-mysql title="Permanent link">⚑</a></h4> <p><strong>Внутрішня структура.</strong> PostgreSQL працює на процесах, в той час як MySQL на потоках. Для роботи з PostgreSQL для пришвидчення швидкодії та економії ресурсів рекомендується використовувати пул з'єднань - PgBouncer або PGPool. Це допоможе зекономити і на мережевих запитах - не потрібно буде кожен раз встановлювати з'єднання, і ресурси самого сервера - не треба буде наново створювати процеси. У MySQL є внутрішні механізми, які вміють кешувати ресурси, тобто не віддавати одразу операційній системі.</p> <p><strong>Особливості зберігання даних.</strong> В MySQL для зберігання даних у таблицях використовуються різні двигуни. Двигун не має впливу на синтаксис запитів та їх виконання. Є підтримка MyISAM, InnoDB, MEMORY, Berkeley DB. Їхньою основною відмінністю є спосіб запису даних на диск та методи зчитування. PostgreSQL працює лише на двигуні зберігання даних. Таблиці організовані як об'єкти, а дії виконуються за допомогою об'єктно-орієнтованих функцій.</p> <p><strong>Стандарти SQL.</strong> SQL - це стандартизована мова виконання запитів, яка використовується як в MySQL, так і в PostgreSQL. Цей стандарт має кілька версій і був розроблений ще в 1986 році.</p> <p>MySQL підтримує не всі функції та можливості SQL. Це зроблено для того, щоб працювати з MySQL було просто та зручно. Але якщо для проекту необхідне яке-небудь розширення, розробники можуть додати його, не жертвуючи стандартом.</p> <p>MySQL та PostgreSQL підтримують всі нові стандарти SQL, тобто по функціоналу ці СУБД на сьогодні відрізняються незначно.</p> <p><strong>ACID.</strong> В обох системах використовується MVCC (MultiVersion Concurrency Control) - Керування паралельним доступом за допомогою багатоверсійності. Коли база даних, що використовує MVCC, потребує оновити елемент даних, вона не перепише оригінальний елемент даних новою інформацією, а створить новішу версію елементу даних. Таким чином зберігається декілька версій. Версія, що кожна транзакція бачить, залежить від того який рівень ізоляції реалізується. В Postrgesql паралельно існують кілька версій рядка. Очищення відбувається за допомогою auto vacuum. Натомість MySQL зберігає завжди актуальну інформацію, а окремо зберігає інформацію про компенсуючу (undo) транзакцію, яка містить дельту, як повернути все назад. Тому займає менше місця, ніж в Postrgesql. Auto vacuum затратний процес. Але якщо його запускати занадто рідко, то старі дані не будуть встигати очищатись, і таблиця буде "розпухати". Відповідно там де треба Sec Scan - він буде сканувати багато неактуальної інформації. Тобто з великою кількістю транзакція MySQL працює краще.</p> <p><strong>Можливості обробки даних.</strong> MySQL під час виконання запиту завантажує всю відповідь сервера в пам'ять клієнта. У випадку великих обсягів це не завжди зручно. Функціональності Postgresql ширші, ніж у Mysql. Наприклад, в Postgresql за допомогою курсора можна переміщувати отримані дані. Надається лише вказівник, а вся відповідь зберігається в пам'яті сервера баз даних. Цей вказівник можна зберігати між сеансами. PostgreSQL підтримує регулярні вирази у запитах, рекурсивні запити та успадкування таблиць.</p> <p><strong>Продуктивність MySQL і Postgresql.</strong> Postgresql краще виконує складні аналітичні запити за багатьма JOIN, оскільки планувальник запитів має доступ до внутрішньої статистики. В свою чергу Storage Engine в MySQL надає API, оскільки є кілька його реалізацій. Тож Query execution engine не має доступу до всієї статистики для побудови оптимального запиту.</p> <p>MySQL завжди був орієнтований на велику продуктивність, тоді як Postgresql був спрямований на багато налаштувань та стандартів. Але з часом ця ситуація змінилася, і Postgre став більш продуктивним.</p> <p>Для організації роботи з базою даних в MySQL використовується таблиця InnoDB. Це означає, що MySQL буде значно швидше за Postgre при використанні первинного ключа.</p> <p>Стосовно Postgresql, вся заголовкова інформація таблиць розміщується в оперативній пам'яті. Можна застосовувати кілька індексів до однієї таблиці для більшої зручності. Взагалі PostgreSQL працює швидше, крім ситуацій із використанням первинних ключів.</p> <p><strong>Підтримувані типи даних.</strong> MySQL і Postgresql мають схожий набір типів, який має свої відмінності.</p> <p><strong>Індекси.</strong> Є 2 основних типи архітектури індексів</p> <ul> <li>Кластерний індекс</li> <li>Проіндексовані значення зберігаються разом з даними</li> <li>Дані зберігаються в відсортованому вигляді в порядку, заданому індексом</li> <li>У таблиці може бути тільки один індекс такого типу</li> <li>Некластерний індекс</li> <li>Проіндексовані значення і дані зберігаються окремо</li> <li>Індекс містить вказівники на решту даних рядка</li> </ul> <p>Postgresql має тільки некластерні індекси, оскільки дані зберігаються окремо в табличній кучі (Table Heap). Завдяки цьому Postgresql підтримує великий вибір вбудованих типів індексу - B-Tree Index, Hash Index, GIN, GiST, SP-GiST, BRIN.</p> <p>Postgresql підтримує </p> <ul> <li>складні - дозволяє індексувати кілька стовпців (є і в MySql)</li> <li>часткові - дозволяє індексувати не всі значення, а які виконують певно умову</li> <li>функціональні індекси - дозволяє індексувати не оригінальне значення, а значення змінене якоюсь функцією</li> </ul> <div class="language-sql highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>id_users_age_gender</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>people</span><span class=p>(</span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=n>gender</span><span class=p>);</span><span class=w> </span><span class=c1>-- complex</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_users_age_partial</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>people</span><span class=p>(</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>25</span><span class=p>;</span><span class=w> </span><span class=o>-</span><span class=err>—</span><span class=w> </span><span class=k>partial</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_users_names</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>people</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=p>);</span><span class=w> </span><span class=c1>-- functional</span>
</span></code></pre></div> <p>У MySQL в таблиці може бути 1 кластерний та кілька некластерних вторинних індексів. І дані на диску завжди відсортовані на основі первинного ключа. MySQL підтримує в явному вигляді тільки B-Tree Index, Hash Index створити не можна, але він використовується самим движком InnoDB в службових цілях. MySQL підтримує Index Hints, що дає можливість вказати які індекси використовувати або ігнорувати.</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w> </span><span class=n>USE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=p>(</span><span class=n>col1_index</span><span class=p>,</span><span class=w> </span><span class=n>col2_index</span><span class=p>)</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=k>WHERE</span><span class=w> </span><span class=n>col1</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>col2</span><span class=o>=</span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>col3</span><span class=o>=</span><span class=mi>3</span><span class=p>;</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w> </span><span class=k>IGNORE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=p>(</span><span class=n>col3_index</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=k>WHERE</span><span class=w> </span><span class=n>col1</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>col2</span><span class=o>=</span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>col3</span><span class=o>=</span><span class=mi>3</span><span class=p>;</span>
</span></code></pre></div> <p><em>Links</em></p> <ul> <li><a href=https://hyperhost.ua/info/ru/sravnenie-mysql-i-postgresql>Сравнение MySQL и PostgreSQL</a></li> <li><a href="https://youtu.be/mg70LYuRS3I?si=wfwM0e9mOt8KcXY2">MySQL и PostgreSQL: что "под капотом" и почему это важно знать прикладному разработчику</a></li> </ul> <h4 id=_4>Які типи зв'язків бувають в БД?<a class=headerlink href=#_4 title="Permanent link">⚑</a></h4> <p>Типи зв'язків визначають способи, якими дані взаємодіють у базі даних.</p> <p><strong>Один до Одного (One-to-One)</strong> - в цьому типі зв'язку кожен запис в одній таблиці пов'язаний з одним і лише одним записом в іншій таблиці. Цей зв'язок використовується тоді, коли об'єкти в обох таблицях пов'язані взаємно один до одного. Типовий приклад - User і UserProfile.</p> <p><strong>Один до Багатьох (One-to-Many)</strong> - у цьому типі зв'язку кожен запис в одній таблиці може бути пов'язаний з багатьма записами в іншій таблиці. Наприклад, один користувач може мати багато замовлень.</p> <p><strong>Багато до Багатьох (Many-to-Many)</strong> - у цьому типі зв'язку кожен запис в одній таблиці може мати зв'язок з багатьма записами в іншій таблиці, і навпаки. Цей тип зв'язку вимагає введення додаткової таблиці, яка з'єднує записи обох таблиць. Наприклад автори і книги. Один автор може мати багато книг, і одна книга може мати багато авторів.</p> <p><strong>Сам до Себе (Self-Referencing)</strong> - це спеціальний тип зв'язку, коли записи в одній таблиці можуть мати зв'язок з іншими записами в цій же таблиці. Наприклад, в таблиці "Користувачі" може бути поле "Батько", яке посилається на інший запис у тій же таблиці, створюючи ієрархію користувачів.</p> <h4 id=_5>Що таке індекси? Навіщо вони потрібні? Як вони працюють?<a class=headerlink href=#_5 title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p><strong>Індекси</strong> - це структури даних у базах даних, які допомагають прискорити пошук і фільтрацію даних. Вони створюються для певних полів таблиць і дозволяють базі даних здійснювати швидший доступ до конкретних рядків.</p> </blockquote> <p>Індекси потрібні для покращення продуктивності запитів, особливо коли потрібен пошук або фільтрація даних за певними полями. Вони допомагають зменшити кількість рядків, які база даних повинна перевірити, щоб знайти відповідні результати.</p> <p>Індекси працюють шляхом створення додаткової структури даних, яка має відображення на значення поля та посилання на відповідний рядок у таблиці. При пошуку даних за індексованим полем база даних спочатку переходить до відповідного запису в індексі, а потім знаходить відповідний рядок у таблиці.</p> <p>Індекси не є безкоштовними. Вони займають додатковий обсяг місця на диску і впливають на швидкість вставки, оновлення і видалення даних. Тому їх слід створювати обдумано, зважаючи на типи запитів, які будуть використовуватися в проекті.</p> <p>Індекси підвищують продуктивність запитів на вибірку даних, але одночасно можуть збільшити час виконання операцій вставки, оновлення та видалення, адже база даних також повинна оновити індекс.</p> <p>У PostgreSQL індекси реалізовані різними способами. Наприклад, B-дерева є одним з найпоширеніших типів індексів. Вони дозволяють швидкий пошук значень і забезпечують ефективну підтримку різних операцій порівняння, таких як менше, більше, дорівнює тощо.</p> <p><em>Links</em></p> <ul> <li><a href="https://www.youtube.com/watch?v=ju9F8OvnL4E">https://www.youtube.com/watch?v=ju9F8OvnL4E</a></li> </ul> <h4 id=_6>Які популярні типи індексів існують?<a class=headerlink href=#_6 title="Permanent link">⚑</a></h4> <ul> <li><strong>B-дерево (B-Tree) індекс:</strong> Це один з найпоширеніших типів індексів. B-дерева використовуються для оптимізації пошуку даних у впорядкованих полях, таких як числа та рядки. Вони дозволяють виконувати операції порівняння (менше, більше, дорівнює) дуже швидко.</li> <li><strong>Хеш-індекс:</strong> Хеш-індекси використовують хеш-функції для швидкого пошуку даних. Вони підходять для запитів з точним збігом значень. Однак, вони не так ефективні для діапазонних запитів або запитів, які використовують оператори порівняння.</li> <li><strong>GIN (Generalized Inverted Index) індекс:</strong> Цей тип індексу використовується для повнотекстового пошуку та інших варіантів пошуку, які вимагають обробки великої кількості слів або термінів.</li> <li><strong>GiST (Generalized Search Tree) індекс:</strong> GiST індекси призначені для роботи зі складними даними, такими як географічні дані, діапазони дат та інші. Це збалансоване дерево пошуку, точно так само, як і розглянуте раніше B-дерево. Але B-дерево застосовне лише до тих типів даних, для яких має сенс операція порівняння та є можливість упорядкування. Проте PostgreSQL дозволяє зберігати і такі дані, для яких операція упорядкування не має сенсу, наприклад, геодані та геометричні об'єкти.</li> <li><strong>SP-GiST (Space-Partitioned Generalized Search Tree) індекс:</strong> Цей тип індексу використовується для роздільних даних, які можна розбити на області. Наприклад, для географічних даних це можуть бути координати на карті. SP-GiST схожий із GiST, але він дозволяє створювати незбалансовані дерева. Такі дерева можуть бути корисними при розбитті множини на об'єкти які не перетинаються. Літери SP означають space partitioning.</li> </ul> <p><em>Links</em></p> <ul> <li><a href=https://tproger.ru/articles/indeksy-v-postgresql/ >https://tproger.ru/articles/indeksy-v-postgresql/</a></li> </ul> <h4 id=uuid>UUID<a class=headerlink href=#uuid title="Permanent link">⚑</a></h4> <p><strong>UUID (Universally Unique Identifier)</strong> — це унікальний ідентифікатор, який широко використовується для створення унікальних значень, незалежно від середовища, де вони генеруються. У Python для роботи з UUID використовується стандартний модуль <code>uuid</code>.</p> <p>UUID гарантує глобальну унікальність без потреби централізованого генератора. Тобто UUID можна генерувати на різних машинах без ризику конфліктів. Це особливо корисно в розподілених системах, де різні вузли мають створювати унікальні ID без координації. З <code>int</code> треба дбати про автоінкремент і потенційні дублікати в розподілених системах.</p> <p>Є кілька версій UUID, які підтримує Python</p> <ul> <li><code>uuid1()</code> — базується на timestamp + MAC-адресі. Вразливий до витоку інформації про пристрій (можна деанонімізувати пристрій).</li> <li><code>uuid3()</code> — генерується з імені + namespace, використовуючи хеш MD5.</li> <li><code>uuid4()</code> — базується на випадкових числах, що забезпечує високий рівень унікальності. Повністю випадковий (найчастіше використовується).</li> <li><code>uuid5()</code> — як uuid3, але з SHA-1 замість MD5.</li> </ul> <p>У базах даних часто використовують UUID як primary key для моделей, що дає додаткову безпеку (складно передбачити значення ID). UUID зручно використовувати для API: вони не інкрементальні, тому менш вразливі до "ID guessing".</p> <p>При збереженні UUID в базі даних зазвичай використовують тип <code>UUIDField</code> у Django, який мапиться на <code>uuid</code> тип у PostgreSQL (або як <code>char(32)</code> у SQLite).</p> <p>UUID складається із 128-бітного числа, представленого у вигляді 32-символьного рядка шістнадцяткових цифр, розділеного дефісами. Наприклад: <code>550e8400-e29b-41d4-a716-446655440000</code>. У UUID4 ймовірність колізії настільки мала, що її практично можна ігнорувати.</p> <p>Мінуси UUID</p> <ul> <li>Розмір: UUID займає більше місця (16 байт проти 4 байт для <code>int</code>). Може призводити до збільшення розміру індексів (і відповідно БД) та сповільнення операцій вставки й пошуку.</li> <li>Продуктивність: У базах даних, де використовуються кластеризовані індекси, додавання UUID (особливо версії 4) може бути менш ефективним, оскільки ці ідентифікатори вставляються у випадковому порядку. У деяких реляційних СУБД (наприклад, SQL Server, MySQL) первинний ключ за замовчуванням є кластеризованим індексом. Ті самі проблеми відносяться що BTree. Це може спричиняти фрагментацію індексу та впливати на продуктивність. Через хаотичність UUID4 PostgreSQL вимушений постійно відкривати різні сторінки індексу, а не одну й ту ж. Це веде до менш ефективного кешу та зростання I/O. Тобто через більший розмір і відсутність порядку UUID індекси гірше кешуються, що може сповільнити пошук, сортування та джоїни. Числові ключі швидші для порівняння, пошуку та індексації.</li> <li>Зручність: UUID важче читати й використовувати при налагодженні або ручній роботі з базою даних у порівнянні з простими числовими ідентифікаторами. Для людини зручніше працювати з простими числами, ніж з довгими UUID.</li> <li>Пагінація: На великих таблицях стандартна пагінація <code>LIMIT...OFFSET</code> починає повільно працювати. Якщо поле <code>int</code> - можна просто фільтрувати по його значенню. З UUID таке покращення не вдасться застосувати.</li> </ul> <p>Частково проблеми uuid4 вирішуються в uuid7. UUID7 — це той самий знайомий формат UUID, але оптимізований для продуктивності та порядковості. Він покликана вирішити ключову проблему <code>uuid4</code> — хаотичність і слабку індексацію.</p> <p>Переваги в порівнянні з <code>uuid4</code></p> <ul> <li>Порядковість (sortable) - UUID7 включає timestamp в перших байтах, що робить його монотонним — нові значення автоматично йдуть після старих. Це ідеально підходить для кластеризованих індексів. На відміну від <code>uuid4</code>, UUID7 можна використовувати для <code>ORDER BY</code>, <code>LIMIT</code>, <code>pagination</code> без додаткового поля типу <code>created_at</code>.</li> <li>Менше фрагментації - Порядкові UUID краще вписуються в кластеризований індекс — дані вставляються "в кінець", а не "в середину", як це буває з <code>uuid4</code>. Це зменшує фрагментацію сторінок у базі й пришвидшує вставку.</li> <li>Все ще унікальний - UUID7 використовує мікс <code>timestamp</code> + <code>randomness</code>, що зберігає глобальну унікальність і забезпечує надійність у розподілених системах.</li> </ul> <p>Підсумок</p> <ul> <li>Якщо проект критично залежить від продуктивності, і UUID не є обов'язковими — краще використовувати <code>int</code>.</li> <li>Якщо важлива безпека, масштабованість і незалежність — UUID має сенс, особливо для публічних ресурсів або мікросервісів.</li> </ul> <h4 id=create-index-concurrently>В яких випадках використовується <code>CREATE INDEX CONCURRENTLY</code><a class=headerlink href=#create-index-concurrently title="Permanent link">⚑</a></h4> <p>Опція <code>CONCURRENTLY</code> при створенні індексів використовується для того, щоб дозволити доступ до таблиці під час процесу створення індексу. Це допомагає створювати індекси для великих таблиць, коли потрібно забезпечити доступ 24/7, оскільки звичайне створення індексу викликає блокування, яке може впливати на доступність системи та продуктивність. Ось деякі випадки, коли використання <code>CREATE INDEX CONCURRENTLY</code> є доцільним:</p> <p>Використання <code>CONCURRENTLY</code> може зайняти більше часу порівняно зі звичайним створенням індексу, але це дозволяє уникнути блокування таблиці.</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=p>(</span><span class=k>column_name</span><span class=p>);</span>
</span></code></pre></div> <h4 id=seq-scan>Що таке seq-scan? Коли він виконується, навіть якщо є індекси?<a class=headerlink href=#seq-scan title="Permanent link">⚑</a></h4> <p><strong>Seq-scan (sequential scan)</strong> — це метод доступу до даних у таблиці, який використовується в системах управління базами даних (наприклад, PostgreSQL). Під час seq-scan сервер бази даних читає всі рядки таблиці послідовно, незалежно від того, чи є індекси для цієї таблиці.</p> <p>В посгресі вибір між "використовувати" і "не використовувати" індекс проводиться планувальником і іноді він може вирішити, що робити IndexScan безглуздо, наприклад, якщо таблиця дуже маленька (але не тільки в цьому випадку).</p> <p>Коли виконується seq-scan, навіть якщо є індекси</p> <ul> <li><strong>Запит сканує значну частину таблиці</strong> - якщо запит повертає великий відсоток рядків таблиці, сервер може вирішити, що використання seq-scan швидше, ніж доступ через індекси. Індекси підходять для вузьких вибірок, але якщо потрібно зчитати майже всі дані, seq-scan стає вигіднішим.</li> <li><strong>Індекси не охоплюють умову фільтрації</strong> - якщо у запиті є умова фільтрації, яка не відповідає існуючому індексу (наприклад, фільтрація за полем, яке не індексоване), база даних змушена виконувати seq-scan.</li> <li><strong>Маленький розмір таблиці</strong> - для дуже маленьких таблиць використання seq-scan може бути швидшим, ніж доступ через індекси, оскільки читання даних напряму із таблиці уникає додаткових накладних витрат на пошук у індексі.</li> <li><strong>Інкрементальні оновлення таблиці</strong> - якщо таблиця має багато нещодавно доданих/змінених рядків (через механізм MVCC у PostgreSQL), сервер може обрати seq-scan, щоб уникнути накладних витрат на підтримку актуальності індексів. Регулярне виконання <code>ANALYZE</code> та <code>VACUUM</code> допомагає оптимізатору краще оцінювати розмір таблиці та вибирати правильний план.</li> <li><strong>Складні функції або вирази</strong> - якщо запит використовує функції або складні обчислення у <code>WHERE</code>, і індекс не покриває ці обчислення (наприклад, <code>LOWER(column) = 'value'</code> без створеного індексу для <code>LOWER(column)</code>), індекси не будуть використані.</li> <li><strong>Налаштування параметрів оптимізатора</strong> - у PostgreSQL параметри <code>random_page_cost</code> і <code>seq_page_cost</code> впливають на вибір оптимізатора. Якщо <code>seq_page_cost</code> низький (або рівний за замовчуванням), оптимізатор може віддавати перевагу seq-scan.</li> </ul> <h4 id=acid>Що таке транзакція? Що таке ACID?<a class=headerlink href=#acid title="Permanent link">⚑</a></h4> <p><strong>Транзакція</strong> - це послідовність дій, які виконуються в базі даних або іншій системі з метою забезпечення консистентності даних та виконання операцій атомарно (тобто вони повинні бути виконані цілісно або не виконуватися взагалі - все або нічого). Іншими словами, транзакція - це група дій, які мають бути виконані як єдине ціле. Транзакція є робочою одиницею роботи з базою даних (БД).</p> <p>Транзакція - це внесення змін у БД. Наприклад, якщо ми створюємо, змінюємо або видаляємо запис, то ми виконуємо транзакцію. Дуже важливо контролювати транзакції для гарантування цілісності. Крім того, транзакції дозволяють відновлювати базу даних до попереднього стану в разі виникнення помилки або аварії.</p> <p>Тобто транзакція — це набір SQL-команд, які об'єднані в один фізичний і логічний блок і вважаються, згідно з ACID, найменшим неподільним об'єктом.</p> <p>Основні концепції (властивості) транзакції описуються абревіатурою ACID</p> <ul> <li>Atomicity - Атомарність</li> <li>Consistency - Узгодженість</li> <li>Isolation - Ізоляція</li> <li>Durability - Довговічність</li> </ul> <p><strong>Атомарність (Atomicity)</strong> Атомарність гарантує, що транзакція або виконується повністю або зовсім не виконується. Якщо одна з операцій у послідовності не буде виконана, то вся транзакція буде відмінена. Тут вводиться поняття "відкату" (rollback). Тобто всередині послідовності відбуватимуться певні зміни, але в результаті всі вони будуть скасовані ("відкочені"), і в результаті користувач не побачить жодних змін, тобто зміни повертаються до стану, який був на початку запуску транзакції. У випадку вкладених транзакцій, rollback відбувається до найближчого SAVEPOINT.</p> <p>Наприклад, якщо гроші списалися з одного рахунку, але не надійшли на інший через помилку, вся операція скасовується і гроші залишаються на першому рахунку. </p> <p><strong>Узгодженість (Consistency)</strong> Узгодженість означає, що будь-яка завершена транзакція (транзакція, яка досягла завершення транзакції - end of transaction) фіксує лише допустимі результати. Система має перебувати в узгодженому, несуперечливому стані до початку дії транзакції і по її завершенню - не має бути порушення FK, PK, Unique key та інших обмежень даних. При цьому вона може перебувати в неузгодженому стані протягом виконання транзакції, проте ця неузгодженість не буде видимою за межами транзакції завдяки іншим властивостям — атомарності та ізольованості.</p> <p>Наприклад, при переведенні коштів з рахунку на рахунок, кошти можна спочатку зняти з першого рахунку, після чого нараховувати на другий. Відповідно, після зняття коштів, але до їх нарахування система перебуває в неузгодженому стані: коштів немає на жодному з рахунків. Але після завершення транзакції повна сума перебуватиме на другому (або першому у випадку скасування транзакції) рахунку.</p> <p><strong>Ізоляція (Isolation)</strong> Кожна транзакція повинна бути ізольована від інших, тобто її результат не повинен залежати від виконання інших паралельних транзакцій та не повинна впливати одна на одну. На практиці, ізоляції важко досягнути, тому тут вводиться поняття "рівні ізоляції" (транзакція ізолюється не повністю).</p> <p>Наприклад дві людини одночасно намагаються змінити баланс на одному рахунку. Ізольованість гарантує, що одна транзакція не вплине на іншу.</p> <p><strong>Довговічність (Durability)</strong> Довговічність означає, що після успішного завершення транзакції її результати зберігаються у базі даних, навіть якщо відбувається збій системи. Це означає, що дані не втрачаються і залишаються доступними після будь-яких помилок, таких як збій живлення.</p> <p>Наприклад після того, як ви завершили переказ грошей, нова інформація про баланси зберігається і залишається доступною, навіть якщо сервер бази даних раптово вимкнеться. Коли сервер перезапуститься, дані будуть відновлені, оскільки транзакцію було завершено.</p> <p><em>Links</em></p> <ul> <li><a href=https://dou.ua/forums/topic/46677/ >Використання транзакцій в реляційних базах даних: забезпечення надійності та цілісності</a></li> </ul> <h4 id=_7>Які команди управління транзакціями ви знаєте<a class=headerlink href=#_7 title="Permanent link">⚑</a></h4> <p>Для управління транзакціями використовуються наступні команди</p> <ul> <li><code>COMMIT</code>: Зберігає зміни</li> <li><code>ROLLBACK</code>: Відкочує (скасовує) зміни</li> <li><code>SAVEPOINT</code>: Створює точку, до якої група транзакцій може відкотитися</li> <li><code>SET TRANSACTION</code>: Розміщує ім'я транзакції.</li> </ul> <p>Команди управління транзакціями використовуються тільки для DML команд: <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>. Вони не можуть бути використані під час створення, зміни або видалення таблиці.</p> <p><em>Links</em></p> <ul> <li><a href=https://proselyte.net/tutorials/sql/sql-transactions/ >Руководство по SQL. Транзакции</a></li> </ul> <h4 id=_8>Що таке рівні ізоляції транзакцій. Які вони бувають<a class=headerlink href=#_8 title="Permanent link">⚑</a></h4> <p><strong>Ізоляція</strong> у сенсі ACID означає, що конкурентно виконувані транзакції ізольовані одна від одної - вони не можуть заважати одна одній. Класичні підручники з баз даних розуміють під ізоляцією серіалізованість (serializability). Тобто кожна транзакція виконується так, наче вона єдина в усій базі. БД гарантує, що результат фіксації транзакцій такий самий, як якщо б вони виконувались послідовно (по одній за раз), хоча насправді вони можуть виконуватись конкурентно.</p> <p>При паралельному виконанні транзакцій можливі такі проблеми</p> <ul> <li>втрачене оновлення (lost update) - при одночасній зміні одного блоку даних різними транзакціями, одна із змін втрачається. Наприклад, T1 i T2 працюють над записом з полем foo = 10, T1 додає до поля 5 а T2 додає 15. У результаті ми очікуємо, що буде 30, але транзакція T1 не знає нічого про T2 і навпаки. Вони працюють із полем foo, яке знаходиться в їхній пам'яті, а не з реальним значенням, що міститься в базі, тому зміни T1 або T2 будуть втрачені.</li> <li>"брудне" читання (dirty read) - читання даних, які додані чи змінені транзакцією, яка потім не підтвердиться (відкотиться). Наприклад, T1 i T2 працюють над записом із полем foo=10, T1 додає 5, а T2 додає 15. У цьому випадку, якщо одна транзакція змінила поле, інша побачить це та буде працювати з новим полем. Але якщо одна з транзакцій не виконається після того, як інша завершить своє виконання, дані не будуть повернуті в попередній стан. Тобто якщо T1 завершить свою роботу раніше Т2, в полі foo буде 30, а не 25.</li> <li>неповторюване читання (non-repeatable read) - транзакція читає один і той самий запис в рамках однієї транзакції, але отримує різні значення. Наприклад, T1 читає запис, через деякий час T2 закінчує оновлення полів цього запису і при повторному читанні T1 отримує інший результат значень полів.</li> <li>фантомне читання (phantom reads) - схожа до non-repeatable read, але одна транзакція в ході свого виконання декілька разів вибирає множину рядків за одними і тими ж критеріями. Інша транзакція в інтервалах між цими вибірками додає чи видаляє рядки чи змінює стовпці деяких рядків, що використовується в критеріях вибірки першої транзакції, і успішно закінчується. В результаті отримаємо, що одні і ті ж вибірки в першій транзакції дають різні множини рядків, містять більше/менше записів відносно попередньої операції.</li> </ul> <p><strong>Рівень ізольованості транзакцій</strong> — значення, що задає рівень, при якому в транзакції дозволяються неузгоджені дані, тобто ступінь ізольованості однієї транзакції від іншої. Більш високий рівень ізольованості підвищує точність даних, але при цьому може знижуватись кількість транзакцій, що виконуються паралельно. З іншого боку, більш низький рівень ізольованості дозволяє виконувати більше паралельних транзакцій, але знижує точність даних. Тобто при найменшому рівні ізоляції ми отримуємо найбільший перформанс і навпаки.</p> <p>У стандарті SQL описується чотири рівні ізоляції транзакцій</p> <ul> <li>Read uncommited (Читання незафіксованих даних)</li> <li>Read committed (Читання зафіксованих даних)</li> <li>Repeatable read (Повторюване читання)</li> <li>Serializable (Серіалізований)</li> </ul> <p><strong>Читання незафіксованих даних (Read Uncommitted)</strong> Найнижчий рівень ізоляції. Транзакція може читати дані, які ще не були зафіксовані іншою транзакцією. Це може призводити до "брудного читання" (dirty reads), коли транзакція працює з даними, які можуть бути відкочені.</p> <p><strong>Читання зафіксованих даних (Read Committed)</strong> Транзакція бачить лише ті зміни, які вже зафіксовані іншими транзакціями. Це запобігає "брудному читанню", але не вирішує проблему "неповторюваного читання" (non-repeatable reads), коли один і той самий запит повертає різні результати в межах однієї транзакції.</p> <p>У загальному використанні без <code>FOR UPDATE/SHARE</code> операції працюють зі snapshot-даними, ніякі блокування полів для читання (shared lock) не застосовуються.</p> <p>Реалізація завершеного читання може ґрунтуватися на одному з двох підходів: блокуванні або версійності.</p> <ul> <li><strong>Блокування даних, що читаються та змінюються.</strong><ul> <li>Полягає в тому, що записуюча транзакція блокує змінні дані для читаючих транзакцій, що працюють на рівні read committed або вищому, до свого завершення, перешкоджаючи таким чином "брудному" читанню, а дані, що зчитуються, які блокуються транзакцією, звільняються одразу після завершення операції <code>SELECT</code> (отже ситуація "неповторного читання" може виникати на даному рівні ізоляції).</li> </ul> </li> <li><strong>Збереження декількох версій рядків, що змінюються паралельно.</strong><ul> <li>При кожній зміні рядка СУБД створює нову версію цього рядка, з якої продовжує працювати транзакція, що змінила дані, в той час як будь-якій іншій "читає" транзакції повертається остання зафіксована версія. Перевага такого підходу в тому, що він забезпечує більшу швидкість, оскільки запобігає блокуванню. Однак він вимагає, порівняно з першим, значно більшої витрати оперативної пам'яті, яка витрачається на зберігання версій рядків.</li> </ul> </li> </ul> <p><strong>Повторюване читання (Repeatable Read)</strong> Забезпечує, що дані, прочитані транзакцією, залишаються незмінними до її завершення. Вирішує проблему "неповторюваного читання", але не запобігає "фантомному читанню" (phantom reads), коли нові рядки додаються іншими транзакціями і впливають на результати.</p> <p>Тобто транзакція весь час буде працювати тільки з однією копією snapshot-а, але власні зміни будуть видимі для всіх операцій всередині транзакції.</p> <p>Транзакція на цьому рівні ізоляції не може використовувати exclusive lock для полів, що були модифіковані іншою транзакцією, або змінювати модифіковані поля. Якщо ж транзакція спробує це зробити, вона отримає помилку серіалізації. Усі зміни повинні відкотитись, і потрібно спробувати провести транзакцію знову.</p> <p><strong>Серіалізований (Serializable)</strong> Найвищий рівень ізоляції. Гарантує, що транзакції виконуються так, ніби вони були послідовними, тобто одна за одною. Усуває всі згадані проблеми, включаючи "фантомне читання", але може значно знизити продуктивність через блокування ресурсів.</p> <p>За замовчуванням у PostgreSQL рівень ізоляції Read Committed (Read uncommitted є тим самим, що й Read committed завдяки використанню MVCC). Такий рівень ізоляції завжди дозволяє бачити зміни внесені успішно завершеними транзакціями в паралельно відкритих транзакціях, що залишилися. У транзакції, що працює на цьому рівні, запит SELECT (без FOR UPDATE/SHARE) бачить лише дані, які були зафіксовані до початку запиту; він ніколи не побачить незафіксованих даних чи змін, внесених у процесі виконання запиту паралельними транзакціями. По суті, запит SELECT бачить знімок бази даних у момент початку виконання запиту. Однак SELECT бачить результати змін, внесених раніше в цій транзакції, навіть якщо вони ще не зафіксовані. Також треба зауважити, що два послідовні оператори SELECT можуть бачити різні дані навіть у рамках однієї транзакції, якщо якісь інші транзакції зафіксують зміни після виконання першого SELECT.</p> <p><em>Links</em></p> <ul> <li><a href=https://dou.ua/forums/topic/53101/ >Реалізація рівнів ізоляцій у базах даних - dou.ua</a></li> </ul> <h4 id=_9>Вкладені транзакції<a class=headerlink href=#_9 title="Permanent link">⚑</a></h4> <p>Вкладеними називаються транзакції, виконання яких ініціюється з тіла вже активної транзакції.</p> <p>Для створення вкладеної транзакції користувачеві не потрібні жодні додаткові команди. Він просто розпочинає нову транзакцію, не закриваючи попередню. Завершення транзакції верхнього рівня відкладається до завершення вкладених транзакцій. Якщо транзакція самого нижчого (вкладеного) рівня завершена невдало і скасована, то всі транзакції верхнього рівня, включаючи транзакцію першого рівня, будуть скасовані. Крім того, якщо декілька транзакцій нижнього рівня завершилися успішно (але не були зафіксовані), однак на середньому рівні (не найвища транзакція) невдало завершилася інша транзакція, то згідно з вимогами ACID відбудеться відкат всіх транзакцій всіх рівнів, включаючи успішно завершені. Лише коли всі транзакції на всіх рівнях завершено успішно, відбувається фіксація всіх зроблених змін у результаті успішного завершення транзакції верхнього рівня.</p> <p>Кожна команда COMMIT TRANSACTION працює лише з останньою розпочатою транзакцією. При завершенні вкладеної транзакції команда COMMIT застосовується до найбільш "глибокої" вкладеної транзакції. Навіть якщо в команді COMMIT TRANSACTION вказано ім'я транзакції вищого рівня, буде завершена транзакція, розпочата останньою.</p> <h4 id=wal>Що таке WAL?<a class=headerlink href=#wal title="Permanent link">⚑</a></h4> <p><strong>WAL (Write-Ahead Logging)</strong> – це метод зберігання логів в базах даних, що забезпечує надійність даних навіть в разі системного збою. Основна ідея полягає в тому, що перш ніж вносити зміни безпосередньо в основний файл бази даних, ці зміни записуються в журнал (лог). Це дозволяє відновлювати базу даних до коректного стану, використовуючи записи в журналі, навіть якщо стався збій під час операції запису.</p> <p>Цей підхід допомагає забезпечити транзакційну цілісність та відновлюваність баз даних, особливо в критично важливих системах.</p> <h4 id=mvcc>Що таке MVCC?<a class=headerlink href=#mvcc title="Permanent link">⚑</a></h4> <p><strong>MVCC (Multi-Version Concurrency Control)</strong> — це спосіб керування паралельним доступом за допомогою багатоверсійності, який дозволяє читачам і записувачам не блокувати одне одного, і широко використовується в системах управління базами даних (СУБД). </p> <p>Основна ідея MVCC полягає у зберіганні кількох версій кожного елемента даних, що дозволяє уникати блокувань між транзакціями читання та запису, оскільки транзакція може тривати довгий час і прочитані дані й дані, що опрацьовуються, будуть заблоковані також. Тобто коли база даних, що використовує MVCC, потребує оновити елемент даних, вона не перепише оригінальний елемент даних новою інформацією, а створить новішу версію елементу даних. Таким чином зберігається декілька версій. Версія, що кожна транзакція бачить, залежить від того який рівень ізоляції реалізується.</p> <p>Коли транзакція читає дані, вона отримує "знімок" бази даних на момент початку транзакції. Зміни, які вносяться іншими транзакціями, не впливають на цей знімок, доки вони не завершаться. Це забезпечує ізоляцію транзакцій і дозволяє уникати конфліктів, а також забезпечує високу продуктивність при паралельних операціях.</p> <p>Але виникає проблема видалення версій, що стали застарілі та ніколи не будуть прочитані. В деяких випадках, виконується процес періодичного очищення застарілих версій. Зазвичай цей процес проходить через всю таблицю та переписує її останньою версією кожного елементу даних. PostgreSQL використовує цей підхід з його VACUUM процесом. Також є недоліком що зменшується швидкість читання через зберігання різних версій одного рядка, і в цьому випадку індекси працюють не так ефективно.</p> <p>Принцип роботи MVCC</p> <ul> <li>У момент запуску транзакції їй присвоюється певна "точка у часі".</li> <li>Вона бачить тільки ті рядки, які були створені або змінені до цієї точки.</li> <li>Зміни, які інші транзакції зробили пізніше, для неї невидимі.</li> <li>Якщо транзакція змінює дані — створюється нова версія рядка, а не редагується стара напряму.</li> </ul> <p>Цей підхід часто використовується в таких СУБД, як PostgreSQL, MySQL (InnoDB), Oracle та інших.</p> <h4 id=_10>Що таке тригери?<a class=headerlink href=#_10 title="Permanent link">⚑</a></h4> <p><strong>Тригери</strong> - це збережені процедури, які автоматично (які користувач не викликає явно) виконуються (або "спрацьовують") при виникненні певних подій або умов в базі даних. Вони можуть бути використані для відстеження змін у таблицях, валідації даних перед вставкою або оновленням, автоматичного виконання певних операцій після виконання певних дій користувача та інші сценарії.</p> <p>Тригери можуть бути визначені для подій, таких як вставка (<code>INSERT</code>), оновлення (<code>UPDATE</code>), видалення (<code>DELETE</code>) записів у таблицях, і вони можуть допомагати забезпечити цілісність даних та реалізувати бізнес-логіку в базі даних.</p> <div class="language-SQL highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1>-- Example trigger in SQL to track changes in the &quot;Clients&quot; table</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=k>CREATE</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=n>track_changes</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=k>AFTER</span><span class=w> </span><span class=k>INSERT</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>Clients</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=k>FOR</span><span class=w> </span><span class=k>EACH</span><span class=w> </span><span class=k>ROW</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=k>BEGIN</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=c1>-- Logging changes in the &quot;Clients&quot; table</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>Change_Log</span><span class=w> </span><span class=p>(</span><span class=n>Action</span><span class=p>,</span><span class=w> </span><span class=k>Timestamp</span><span class=p>,</span><span class=w> </span><span class=k>User</span><span class=p>,</span><span class=w> </span><span class=n>Changes</span><span class=p>)</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>    </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;INSERT/UPDATE/DELETE&#39;</span><span class=p>,</span><span class=w> </span><span class=n>NOW</span><span class=p>(),</span><span class=w> </span><span class=k>CURRENT_USER</span><span class=p>,</span><span class=w> </span><span class=k>NEW</span><span class=p>);</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=k>END</span><span class=p>;</span>
</span></code></pre></div> <h4 id=_11>Що таке курсор і навіщо він потрібен<a class=headerlink href=#_11 title="Permanent link">⚑</a></h4> <p>Запит до реляційної бази даних зазвичай повертає кілька рядків (записів) даних, але програма за один раз обробляє лише один запис. Навіть якщо вона має справу одночасно з декількома рядками (наприклад, виводить дані у формі електронних таблиць), їх кількість все ще обмежена. Крім того, при модифікації, видаленні або додаванні даних робочою одиницею є рядок. У цій ситуації на передній план виступає концепція курсора, і в такому контексті курсор - вказівник на рядок.</p> <p><strong>Курсор в SQL</strong> - це область в пам'яті бази даних, яка призначена для зберігання останнього оператора SQL. Якщо поточний оператор - запит до бази даних, в пам'яті зберігається рядок даних запиту, який називається поточним значенням або поточним рядком курсора. Зазначена область в пам'яті має ім'я і доступна для прикладних програм.</p> <p>Зазвичай курсори використовуються для вибору з бази даних певної підмножини збереженої в ній інформації. В кожний момент часу прикладною програмою може бути перевірений один рядок курсора. Курсори часто використовуються в операторах SQL, вбудованих у написані на мовах процедурного типу прикладні програми. Деякі з них неявно створюються сервером бази даних, тоді як інші визначаються програмістами.</p> <p>У деяких випадках застосування курсора необхідно. Однак, якщо це можливо, цього слід уникати і працювати зі стандартними командами обробки даних: SELECT, UPDATE, INSERT, DELETE. Крім того, що курсори не дозволяють здійснювати операції зміни над всім обсягом даних, швидкість виконання операцій обробки даних за допомогою курсора помітно нижча, ніж у стандартних засобів SQL.</p> <h4 id=vacuum-postgresql>Що таке VACUUM в PostgreSQL<a class=headerlink href=#vacuum-postgresql title="Permanent link">⚑</a></h4> <p>VACUUM вивільняє простір, зайнятий "мертвими" кортежами. Під час звичайних операцій Postgres кортежі, видалені або застарілі в результаті оновлення, фізично не видаляються з таблиці; вони залишаються в ній до виконання команди VACUUM. Таким чином, періодично необхідно виконувати VACUUM, особливо для часто змінюваних таблиць.</p> <h4 id=sql>Як виявити повільний SQL запит?<a class=headerlink href=#sql title="Permanent link">⚑</a></h4> <ul> <li>Логування повільних запитів - У багатьох СУБД є можливість увімкнути логування повільних запитів. Наприклад, у MySQL можна налаштувати параметри <code>slow_query_log</code> та <code>long_query_time</code>, щоб записувати запити, які виконуються довше за заданий час.</li> <li>Профілювання запитів - Використання інструментів, які надають детальну інформацію про виконання запиту. У PostgreSQL команда <code>EXPLAIN</code> або <code>EXPLAIN ANALYZE</code> дозволяє побачити план виконання запиту, оцінити використання індексів, кількість зчитувань та час виконання.</li> <li>Інструменти моніторингу СУБД - Використання спеціалізованих інструментів, таких як <code>pg_stat_statements</code> у PostgreSQL або Performance Schema у MySQL, які відстежують та агрегують інформацію про виконувані запити.</li> <li>Імітація навантаження - Використання інструментів для створення штучного навантаження (наприклад, Apache JMeter) дозволяє оцінити поведінку запитів у реальних умовах.</li> </ul> <h4 id=_12>Що таке профілювання запитів?<a class=headerlink href=#_12 title="Permanent link">⚑</a></h4> <p>Профілювання запитів - це процес аналізу та оптимізації виконання запитів до бази даних.</p> <p>Під час профілювання запитів, ви використовується "EXPLAIN", щоб отримати план виконання запиту. Цей план показує, як база даних обробляє запит, включаючи послідовність операцій та використані ресурси.</p> <p>"EXPLAIN" допомагає ідентифікувати можливі "гарячі точки" в запиті. Це дає змогу розробникам виявити слабкі місця та можливість їх виправити, наприклад створити або оптимізувати індекс, переписати запит або змінити налаштування бази даних.</p> <h4 id=deadlock>Що таке Deadlock? Як їх уникати?<a class=headerlink href=#deadlock title="Permanent link">⚑</a></h4> <p><strong>Deadlock (взаємоблокування)</strong> — це ситуація, коли дві або більше транзакції блокують одна одну, очікуючи на ресурси, які вже заблоковані іншими транзакціями. У такому стані транзакції не можуть завершитися, доки не буде втручання ззовні.</p> <p>Дедлок може виникати, коли дві транзакції блокують одні й ті ж ресурси, але в різному порядку. Наприклад, одна транзакція блокує таблицю <code>A</code> і чекає таблицю <code>B</code>, тоді як інша транзакція блокує <code>B</code> і чекає <code>A</code>.</p> <p>Можливі варіанти для уникнення Deadlock</p> <ul> <li><strong>Зменшення часу утримання блокувань</strong> - Мінімізація кількіості операцій між початком транзакції (<code>BEGIN</code>) і її завершенням (<code>COMMIT</code> або <code>ROLLBACK</code>).</li> <li><strong>Використання рівнів ізоляції</strong> - Вибір відповідного рівня ізоляції (наприклад, <code>READ COMMITTED</code>) може зменшити ймовірність виникнення взаємоблокувань.</li> <li><strong>Розбиття великих транзакцій</strong> - Якщо можливо, розбити великі транзакції на менші, щоб зменшити ризик блокування ресурсів.</li> <li><strong>Використання таймаутів для блокувань</strong> - Налаштування таймауту дозволяє уникнути затяжного очікування у випадку Deadlock. У PostgreSQL, наприклад, це параметр <code>lock_timeout</code>.</li> </ul> <h4 id=_13>Нормалізація баз даних<a class=headerlink href=#_13 title="Permanent link">⚑</a></h4> <p><strong>Нормалізація баз даних</strong> - це процес поділу таблиці на дрібніші, пов'язані таблиці для уникнення надмірності даних та забезпечення узгодженості та цілісності бази даних.</p> <p>Нормалізація дозволяє розділити таблиці таким чином, що кожна таблиця містить лише ті атрибути, які взаємодіють з однією конкретною сутністю. Це виконується за допомогою розподілу таблиць та визначення зв'язків між ними.</p> <p><strong>Денормалізація баз даних</strong> - це процес об'єднання даних із кількох таблиць в одну або кілька денормалізованих таблиць для оптимізації продуктивності та спрощення запитів. </p> <p>Денормалізації включає</p> <ul> <li>Зменшення числа з'єднань таблиць, щоб покращити продуктивність під час виконання запитів.</li> <li>Дублювання даних для спрощення та прискорення вилучення даних.</li> <li>Використання агрегованих стовпців для попереднього обчислення агрегатних функцій.</li> </ul> <p>Нормальні форми в базах даних визначають, наскільки добре структуровані таблиці бази даних щодо уникнення дублювання даних та забезпечення консистентності. Існують кілька рівнів нормальних форм, кожен з яких вказує на певний ступінь оптимізації та структурованості бази даних.</p> <p>Існують такі рівні нормалізації: перша нормальна форма (1НФ), 2НФ, 3НФ, нормальна форма Бойса-Кодда (БКНФ), 4НФ, 5НФ. Але дотепер жодна з реляційних СКБД не надає належної підтримки усім п'яти нормальним формам. Це відбувається через жорсткі вимоги до продуктивності. Суть справи полягає в тому, що в повністю нормалізованій БД для виконання запиту треба з'єднати настільки багато таблиць, що продуктивність такої системи не зможе задовольнити користувачів. Тому на практиці використовують лише перші три рівня нормалізації – 1НФ, 2НФ, ЗНФ.</p> <p>Види нормальних форм</p> <ul> <li>Перша нормальна форма (1NF) утворює ґрунт для структурованої схеми бази даних<ul> <li>Кожна таблиця повинна мати первинний ключ: мінімальний набір колонок, які ідентифікують запис.</li> <li>Відсутні групи атрибутів з однаковими за змістом значеннями, які повторюються у межах одного кортежу.</li> <li>Атомарність - кожен атрибут повинен мати лише одне значення, а не множину значень. Наприклад, якщо у атрибуті "Прізвище, ім'я, по батькові" міститься прізвище, ім'я та по батькові читача, вимога неподільності не виконується</li> </ul> </li> <li>Друга нормальна форма (2NF)<ul> <li>Таблиця повинна бути у 1NF</li> <li>Всі неключові стовпці повинні повністю залежати від первинного ключа.</li> </ul> </li> <li>Третя нормальна форма (3NF)<ul> <li>Таблиця повинна бути у 2NF</li> <li>Усуває транзитивні залежності, тобто кожен неключовий атрибут повинен прямо залежати від первинного ключа, а не від інших неключових атрибутів. Це ще більше зменшує надмірність і підвищує цілісність.</li> </ul> </li> </ul> <p>Переваги нормалізації</p> <ul> <li>Зменшення надмірності даних та забезпечення цілісності бази даних.</li> <li>Поліпшення продуктивності під час оновлення даних.</li> <li>Спрощення структури бази даних, що робить її легшою для розуміння та підтримки.</li> </ul> <p>Недоліки нормалізації</p> <ul> <li>Збільшення складності при вилученні даних із кількох пов'язаних таблиць.</li> <li>Збільшення числа з'єднань таблиць при виконанні складних запитів, що може негативно позначитися на продуктивності.</li> </ul> <p><em>Links</em></p> <ul> <li><a href="https://youtu.be/0kq99Y8m0gw?si=PY9bqnrF4ReGHDbv">https://youtu.be/0kq99Y8m0gw?si=PY9bqnrF4ReGHDbv</a></li> </ul> <h4 id=_14>Партиціювання та шардування<a class=headerlink href=#_14 title="Permanent link">⚑</a></h4> <p>Партиціювання та шардування - це техніки, які дозволяють розбити велику базу даних на менші частини, щоб забезпечити більшу масштабованість та продуктивність.</p> <p><strong>Партиціювання (Partitioning)</strong> - це процес розділення таблиці так, що її дані розділяються на менші, більш керовані та ефективно оброблювані частини, які називаються "партиціями". Кожна партиція може бути розміщена на окремому диску або файловій системі, що дозволяє базі даних обробляти запити швидше, оскільки кожна партиція може бути оброблена незалежно від інших, отже обробляється менше даних. Також, можна створювати індекси на окремих партиціях, що полегшує оптимізацію запитів.</p> <p>Партиціювання включає в себе наступні кроки</p> <ul> <li>Визначення критеріїв партиціювання: це може бути дата, час, ідентифікатор або будь-який інший атрибут, що дозволяє логічно розділити дані.</li> <li>Створення партицій: кожна партиція створюється відповідно до визначених критеріїв.</li> <li>Розподіл даних: дані переносяться в відповідні партиції.</li> </ul> <p><strong>Шардування (Sharding)</strong> - це процес розділення таблиці на менші фрагменти - шарди, які можуть бути збережені на різних серверах. Однак, на відміну від партиціювання, шардування зазвичай використовується для розділення даних на різних серверах у різних локаціях. Це дозволяє збільшити доступність та надійність бази даних, оскільки в разі відмови одного сервера, інші сервери можуть продовжувати працювати.</p> <p>Шардування буває вертикальне і горизонтальне</p> <ul> <li>Горизонтальне шардування відбувається, коли рядки даних розподіляються між різними базами даних (шардами). Кожен шард містить унікальний набір рядків. Наприклад, один шард може містити дані про користувачів з іменами, що починаються на літери A-M, а інший шард - про користувачів з іменами на N-Z.</li> <li>Вертикальне шардування відбувається, коли стовпці даних розподіляються між різними базами даних. Кожен шард містить унікальний набір стовпців. Наприклад, один шард може містити контактну інформацію користувача, а інший - інформацію про замовлення цього користувача.</li> </ul> <h4 id=master-slave>Master-Slave<a class=headerlink href=#master-slave title="Permanent link">⚑</a></h4> <p>Архітектура <strong>Master-Slave</strong> (тепер часто називається <strong>Primary-Replica</strong>, щоб уникнути застарілих термінів) використовується для горизонтального масштабування баз даних і забезпечення високої доступності. У цій моделі одна база даних виступає як Master, а інші як Slave. Використовується для підвищення продуктивності, коли операції читання значно переважають операції запису, або для забезпечення резервування даних. Ця архітектура є популярною для додатків із високими вимогами до масштабованості з великою кількістю запитів на читання.</p> <p><strong>Master (Primary)</strong> - основна база даних, яка приймає всі операції запису. Зміни, внесені до Master, реплікуються (передаються) до всіх Slave.</p> <p><strong>Slave (Replica)</strong> - це одна або більше копій Master, які синхронізуються через реплікацію. Slave обслуговують лише операції читання, що дозволяє розподілити навантаження на систему.</p> <p>Реплікація може бути синхронною (запис на Master завершується тільки після оновлення Slave) або асинхронною (Master завершує операцію запису, не чекаючи синхронізації з Slave).</p> <p>Переваги</p> <ul> <li>Розвантаження Master - операції читання перенаправляються на Slave, що зменшує навантаження на Master.</li> <li>Масштабованість - легко додати нові Slave для обробки більшого обсягу запитів на читання.</li> <li>Резервування даних - у разі відмови Master, один із Slave може бути підвищений до Master.</li> </ul> <p>Недоліки</p> <ul> <li>Затримка реплікації - у разі асинхронної реплікації можуть виникати затримки, що призводять до читання застарілих даних зі Slave.</li> <li>Складність управління - підтримка синхронізації між Master і Slave потребує додаткових ресурсів і інструментів.</li> <li>Відсутність автоматичного переходу на новий Master - у разі відмови Master зазвичай потрібне ручне втручання для призначення нового Master.</li> </ul> <h4 id=oltp-olap>Яка різниця між OLTP та OLAP?<a class=headerlink href=#oltp-olap title="Permanent link">⚑</a></h4> <p>OLTP (Online Transactional Processing) and OLAP (Online Analytical Processing) — це два різних типи обробки даних, які використовуються в сфері інформаційних систем.</p> <p><strong>OLTP (Online Transactional Processing)</strong></p> <ul> <li>Призначення: OLTP призначений для операційної обробки даних. Коли виконуються багато транзакцій в реальному часі.</li> <li>Тип операцій: OLTP обробляє прості операції вставки, оновлення та видалення даних. Наприклад, банківські транзакції, бронювання готелів, зміни паролів тощо.</li> <li>Швидкість обробки: Відповіді мають бути дуже швидкими, з відгуком в мілісекундах.</li> </ul> <p><strong>OLAP (Online Analytical Processing)</strong></p> <ul> <li>Призначення: OLAP призначений для аналізу даних. Коли виконуються складні аналітичні розрахунки на великих обсягах даних. </li> <li>Тип операцій: Використовується для глибокого аналізу даних, такого як добування знань, бізнес-інтелект, прогнозування продажів тощо.</li> <li>Швидкість обробки: OLAP може працювати з великими обсягами даних, тож відповіді можуть бути повільними.</li> </ul> <h4 id=_15>Сесія, курсор<a class=headerlink href=#_15 title="Permanent link">⚑</a></h4> <p><strong>Сесія</strong> - це окремий сеанс зв'язку між клієнтом і сервером бази даних. Сесія починається при встановленні з'єднання з БД і закінчується після його завершення. У рамках однієї сесії клієнт може виконувати кілька запитів до бази. Для кожної сесії сервер виділяє ресурси, що може стати обмеженням при великій кількості підключень.</p> <p><strong>Курсор</strong> - це об'єкт, який використовується для виконання SQL-запитів і отримання результатів. Курсор дозволяє обробляти результати запиту поетапно, зменшуючи обсяг пам'яті, необхідної для зберігання даних у пам'яті клієнта. </p> <p>Приклад роботи з курсором у Python (модуль <code>psycopg2</code>)</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>psycopg2</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>connection</span> <span class=o>=</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s2>&quot;dbname=test user=postgres password=secret&quot;</span><span class=p>)</span>  <span class=c1># Connect to the database</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=n>cursor</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>  <span class=c1># Create a cursor</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&quot;SELECT * FROM users&quot;</span><span class=p>)</span>  <span class=c1># Execute a query</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cursor</span><span class=o>.</span><span class=n>fetchall</span><span class=p>():</span>  <span class=c1># Fetch results</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>    <span class=nb>print</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=n>cursor</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>  <span class=c1># Close cursor and connection</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></code></pre></div> <h4 id=pgbouncer>Пул з'єднань, PgBouncer<a class=headerlink href=#pgbouncer title="Permanent link">⚑</a></h4> <p><strong>Пул з'єднань</strong> - це механізм повторного використання вже існуючих з'єднань із базою даних. Він дозволяє уникнути витрат на створення нових з'єднань при кожному запиті, що суттєво підвищує продуктивність додатка.</p> <p>В Python пул з'єднань можна реалізувати за допомогою бібліотеки <code>psycopg2</code> або ORM, як-от SQLAlchemy:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sqlalchemy</span><span class=w> </span><span class=kn>import</span> <span class=n>create_engine</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sqlalchemy.orm</span><span class=w> </span><span class=kn>import</span> <span class=n>sessionmaker</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=n>engine</span> <span class=o>=</span> <span class=n>create_engine</span><span class=p>(</span><span class=s2>&quot;postgresql://user:password@localhost/db&quot;</span><span class=p>,</span> <span class=n>pool_size</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>max_overflow</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>  <span class=c1># Create a connection pool</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>Session</span> <span class=o>=</span> <span class=n>sessionmaker</span><span class=p>(</span><span class=n>bind</span><span class=o>=</span><span class=n>engine</span><span class=p>)</span>  <span class=c1># Create a session</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=n>session</span> <span class=o>=</span> <span class=n>Session</span><span class=p>()</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&quot;SELECT * FROM users&quot;</span><span class=p>)</span>  <span class=c1># Execute a query</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>    <span class=nb>print</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=n>session</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>  <span class=c1># Close the session</span>
</span></code></pre></div> <p><strong>PgBouncer</strong> - це легкий проксі-сервер для PostgreSQL, який виконує функції пулінгу з'єднань. PgBouncer дозволяє зменшити навантаження на сервер бази даних, зменшуючи кількість одночасних з'єднань.</p> <p>Він підтримує кілька режимів роботи</p> <ul> <li><strong>Session pooling</strong>: кожне з'єднання клієнта відповідає одній сесії сервера.</li> <li><strong>Transaction pooling</strong>: з'єднання використовується лише для однієї транзакції.</li> <li><strong>Statement pooling</strong>: з'єднання використовується для виконання одного SQL-запиту.</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="July 15, 2025 11:36:11 UTC"><span class=timeago datetime=2025-07-15T11:36:11+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="July 15, 2025 11:36:11 UTC">2025-07-15</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../sql/ class="md-footer__link md-footer__link--prev" aria-label="Previous: SQL"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> SQL </div> </div> </a> <a href=../mq/ class="md-footer__link md-footer__link--next" aria-label="Next: MQ"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> MQ </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/tavor118 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.footer", "navigation.instant", "navigation.top", "content.code.annotate", "content.code.copy", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> </body> </html>