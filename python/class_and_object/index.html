<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=Andrew><link href=https://tavor118.github.io/python-questions-and-answers/python/class_and_object/ rel=canonical><link href=../iterator_and_generator/ rel=prev><link href=../metaclass/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.15"><title>Class and Object - Python Questions and Answers</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../stylesheets/links.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Python Questions and Answers" class="md-header__button md-logo" aria-label="Python Questions and Answers" data-md-component=logo> <img src=../../img/logo.bmp alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Python Questions and Answers </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Class and Object </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/tavor118/pj_python_interview_questions_and_answers title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> tavor118/pj_python_interview_questions_and_answers </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Python Questions and Answers" class="md-nav__button md-logo" aria-label="Python Questions and Answers" data-md-component=logo> <img src=../../img/logo.bmp alt=logo> </a> Python Questions and Answers </label> <div class=md-nav__source> <a href=https://github.com/tavor118/pj_python_interview_questions_and_answers title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> tavor118/pj_python_interview_questions_and_answers </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Python </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../general/ class=md-nav__link> <span class=md-ellipsis> General </span> </a> </li> <li class=md-nav__item> <a href=../syntax/ class=md-nav__link> <span class=md-ellipsis> Syntax </span> </a> </li> <li class=md-nav__item> <a href=../data_types/ class=md-nav__link> <span class=md-ellipsis> Data Types </span> </a> </li> <li class=md-nav__item> <a href=../sequences/ class=md-nav__link> <span class=md-ellipsis> Sequences </span> </a> </li> <li class=md-nav__item> <a href=../set_and_dict/ class=md-nav__link> <span class=md-ellipsis> Set and Dict </span> </a> </li> <li class=md-nav__item> <a href=../loops/ class=md-nav__link> <span class=md-ellipsis> Loops </span> </a> </li> <li class=md-nav__item> <a href=../functions/ class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> <li class=md-nav__item> <a href=../decorators/ class=md-nav__link> <span class=md-ellipsis> Decorators </span> </a> </li> <li class=md-nav__item> <a href=../iterator_and_generator/ class=md-nav__link> <span class=md-ellipsis> Iterator and Generator </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Class and Object </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Class and Object </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> Класи, об'єкти </span> </a> <nav class=md-nav aria-label="Класи, об'єкти"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> Клас </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> Від чого успадковуються класи і метакласи? </span> </a> </li> <li class=md-nav__item> <a href=#__init__ class=md-nav__link> <span class=md-ellipsis> Що робить метод __init__? </span> </a> </li> <li class=md-nav__item> <a href=#__new__-__init__ class=md-nav__link> <span class=md-ellipsis> Що таке __new__ і чим він відрізняється від __init__? У якій послідовності вони виконуються </span> </a> </li> <li class=md-nav__item> <a href=#self-python class=md-nav__link> <span class=md-ellipsis> Що таке self в Python? </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> Як отримати список атрибутів об'єкта </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> Що таке магічні методи та для чого вони потрібні </span> </a> </li> <li class=md-nav__item> <a href=#__str__-__repr__ class=md-nav__link> <span class=md-ellipsis> Яка різниця між __str__ та __repr__? </span> </a> </li> <li class=md-nav__item> <a href=#__getattr__-__getattribute__ class=md-nav__link> <span class=md-ellipsis> Яка різниця між __getattr__ та __getattribute__? </span> </a> </li> <li class=md-nav__item> <a href=#__qualname__ class=md-nav__link> <span class=md-ellipsis> Метод __qualname__ </span> </a> </li> <li class=md-nav__item> <a href=#super class=md-nav__link> <span class=md-ellipsis> Як у класі посилатися на батьківський клас (super()) </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> Чи можливе множинне наслідування </span> </a> </li> <li class=md-nav__item> <a href=#mro class=md-nav__link> <span class=md-ellipsis> Що таке MRO </span> </a> </li> <li class=md-nav__item> <a href=#diamond-problem class=md-nav__link> <span class=md-ellipsis> Що таке проблема ромба (Diamond problem) </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> Що таке міксіни? </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> Абстрактні класи та методи </span> </a> </li> <li class=md-nav__item> <a href=#object-object class=md-nav__link> <span class=md-ellipsis> Чому рівний вираз object() == object() </span> </a> </li> <li class=md-nav__item> <a href=#__slots__ class=md-nav__link> <span class=md-ellipsis> __slots__ </span> </a> </li> <li class=md-nav__item> <a href=#_value-__value class=md-nav__link> <span class=md-ellipsis> Атрибути. В чому сенс _value, __value </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> Що таке качина типізація </span> </a> </li> <li class=md-nav__item> <a href=#overloading class=md-nav__link> <span class=md-ellipsis> Що таке перевантаження оператора (overloading)? </span> </a> </li> <li class=md-nav__item> <a href=#type class=md-nav__link> <span class=md-ellipsis> Як створити клас з допомогою type() </span> </a> </li> <li class=md-nav__item> <a href=#staticmethod-classmethod class=md-nav__link> <span class=md-ellipsis> Методи. @staticmethod, @classmethod </span> </a> </li> <li class=md-nav__item> <a href=#__subclasshook__ class=md-nav__link> <span class=md-ellipsis> Для чого метод __subclasshook__ ? </span> </a> </li> <li class=md-nav__item> <a href=#property class=md-nav__link> <span class=md-ellipsis> Що таке властивість (@property)? </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> Що таке дескриптор </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> Види дескрипторів </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> Методи дескрипторів </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> Проблеми, які можуть виникнути з дескрипторами </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../metaclass/ class=md-nav__link> <span class=md-ellipsis> Metaclass </span> </a> </li> <li class=md-nav__item> <a href=../namespace_and_context_manager/ class=md-nav__link> <span class=md-ellipsis> Namespace and Context Manager </span> </a> </li> <li class=md-nav__item> <a href=../modules_and_packets/ class=md-nav__link> <span class=md-ellipsis> Modules and Packets </span> </a> </li> <li class=md-nav__item> <a href=../exceptions/ class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> <li class=md-nav__item> <a href=../files_and_io/ class=md-nav__link> <span class=md-ellipsis> Files and IO </span> </a> </li> <li class=md-nav__item> <a href=../async/ class=md-nav__link> <span class=md-ellipsis> Async </span> </a> </li> <li class=md-nav__item> <a href=../gil_threads_processes/ class=md-nav__link> <span class=md-ellipsis> GIL Threads Processes </span> </a> </li> <li class=md-nav__item> <a href=../interpreter/ class=md-nav__link> <span class=md-ellipsis> Interpreter </span> </a> </li> <li class=md-nav__item> <a href=../functional_programming/ class=md-nav__link> <span class=md-ellipsis> Functional Programming </span> </a> </li> <li class=md-nav__item> <a href=../standard_library/ class=md-nav__link> <span class=md-ellipsis> Standard Library </span> </a> </li> <li class=md-nav__item> <a href=../python_packages/ class=md-nav__link> <span class=md-ellipsis> Python Packages </span> </a> </li> <li class=md-nav__item> <a href=../coding/ class=md-nav__link> <span class=md-ellipsis> Coding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../python_framework/ class="md-nav__link "> <span class=md-ellipsis> Python Framework </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Python Framework </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python_framework/django/ class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=../../python_framework/drf/ class=md-nav__link> <span class=md-ellipsis> DRF </span> </a> </li> <li class=md-nav__item> <a href=../../python_framework/fast_api/ class=md-nav__link> <span class=md-ellipsis> Fast API </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../computer_science/ class="md-nav__link "> <span class=md-ellipsis> Computer Science </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Computer Science </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer_science/oop/ class=md-nav__link> <span class=md-ellipsis> OOP </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/programming_principles/ class=md-nav__link> <span class=md-ellipsis> Programming Principles </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/solid/ class=md-nav__link> <span class=md-ellipsis> SOLID </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/data_structures/ class=md-nav__link> <span class=md-ellipsis> Data Structures </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/algorithmes/ class=md-nav__link> <span class=md-ellipsis> Algorithms </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/computer_science/ class=md-nav__link> <span class=md-ellipsis> Computer Science </span> </a> </li> <li class=md-nav__item> <a href=../../computer_science/testing/ class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../web_development/ class="md-nav__link "> <span class=md-ellipsis> Web Development </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Web Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../web_development/http/ class=md-nav__link> <span class=md-ellipsis> HTTP </span> </a> </li> <li class=md-nav__item> <a href=../../web_development/rest_soap/ class=md-nav__link> <span class=md-ellipsis> REST SOAP </span> </a> </li> <li class=md-nav__item> <a href=../../web_development/rpc/ class=md-nav__link> <span class=md-ellipsis> RPC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../infrastructure/ class="md-nav__link "> <span class=md-ellipsis> Infrastructure </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../infrastructure/sql/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=../../infrastructure/database/ class=md-nav__link> <span class=md-ellipsis> Database </span> </a> </li> <li class=md-nav__item> <a href=../../infrastructure/mq/ class=md-nav__link> <span class=md-ellipsis> MQ </span> </a> </li> <li class=md-nav__item> <a href=../../infrastructure/docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> <li class=md-nav__item> <a href=../../infrastructure/kubernates/ class=md-nav__link> <span class=md-ellipsis> Kubernates </span> </a> </li> <li class=md-nav__item> <a href=../../infrastructure/server/ class=md-nav__link> <span class=md-ellipsis> Server </span> </a> </li> <li class=md-nav__item> <a href=../../infrastructure/aws/ class=md-nav__link> <span class=md-ellipsis> AWS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../architecture/ class="md-nav__link "> <span class=md-ellipsis> Architecture </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/architecture_patterns/ class=md-nav__link> <span class=md-ellipsis> Architecture Patterns </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/ddd/ class=md-nav__link> <span class=md-ellipsis> DDD </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/system_design/ class=md-nav__link> <span class=md-ellipsis> System Design </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../../development/ class="md-nav__link "> <span class=md-ellipsis> Development </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/git/ class=md-nav__link> <span class=md-ellipsis> Git </span> </a> </li> <li class=md-nav__item> <a href=../../development/ci_cd/ class=md-nav__link> <span class=md-ellipsis> CI/CD </span> </a> </li> <li class=md-nav__item> <a href=../../development/sdlc/ class=md-nav__link> <span class=md-ellipsis> SDLC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../../frontend/ class="md-nav__link "> <span class=md-ellipsis> Front-end </span> </a> <label class="md-nav__link " for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Front-end </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../frontend/front_end/ class=md-nav__link> <span class=md-ellipsis> Front End </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/javascript/ class=md-nav__link> <span class=md-ellipsis> JavaScript </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/dom/ class=md-nav__link> <span class=md-ellipsis> DOM </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/framework/ class=md-nav__link> <span class=md-ellipsis> Framework </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/html/ class=md-nav__link> <span class=md-ellipsis> HTML </span> </a> </li> <li class=md-nav__item> <a href=../../frontend/css/ class=md-nav__link> <span class=md-ellipsis> CSS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> Класи, об'єкти </span> </a> <nav class=md-nav aria-label="Класи, об'єкти"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> Клас </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> Від чого успадковуються класи і метакласи? </span> </a> </li> <li class=md-nav__item> <a href=#__init__ class=md-nav__link> <span class=md-ellipsis> Що робить метод __init__? </span> </a> </li> <li class=md-nav__item> <a href=#__new__-__init__ class=md-nav__link> <span class=md-ellipsis> Що таке __new__ і чим він відрізняється від __init__? У якій послідовності вони виконуються </span> </a> </li> <li class=md-nav__item> <a href=#self-python class=md-nav__link> <span class=md-ellipsis> Що таке self в Python? </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> Як отримати список атрибутів об'єкта </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> Що таке магічні методи та для чого вони потрібні </span> </a> </li> <li class=md-nav__item> <a href=#__str__-__repr__ class=md-nav__link> <span class=md-ellipsis> Яка різниця між __str__ та __repr__? </span> </a> </li> <li class=md-nav__item> <a href=#__getattr__-__getattribute__ class=md-nav__link> <span class=md-ellipsis> Яка різниця між __getattr__ та __getattribute__? </span> </a> </li> <li class=md-nav__item> <a href=#__qualname__ class=md-nav__link> <span class=md-ellipsis> Метод __qualname__ </span> </a> </li> <li class=md-nav__item> <a href=#super class=md-nav__link> <span class=md-ellipsis> Як у класі посилатися на батьківський клас (super()) </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> Чи можливе множинне наслідування </span> </a> </li> <li class=md-nav__item> <a href=#mro class=md-nav__link> <span class=md-ellipsis> Що таке MRO </span> </a> </li> <li class=md-nav__item> <a href=#diamond-problem class=md-nav__link> <span class=md-ellipsis> Що таке проблема ромба (Diamond problem) </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> Що таке міксіни? </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> Абстрактні класи та методи </span> </a> </li> <li class=md-nav__item> <a href=#object-object class=md-nav__link> <span class=md-ellipsis> Чому рівний вираз object() == object() </span> </a> </li> <li class=md-nav__item> <a href=#__slots__ class=md-nav__link> <span class=md-ellipsis> __slots__ </span> </a> </li> <li class=md-nav__item> <a href=#_value-__value class=md-nav__link> <span class=md-ellipsis> Атрибути. В чому сенс _value, __value </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> Що таке качина типізація </span> </a> </li> <li class=md-nav__item> <a href=#overloading class=md-nav__link> <span class=md-ellipsis> Що таке перевантаження оператора (overloading)? </span> </a> </li> <li class=md-nav__item> <a href=#type class=md-nav__link> <span class=md-ellipsis> Як створити клас з допомогою type() </span> </a> </li> <li class=md-nav__item> <a href=#staticmethod-classmethod class=md-nav__link> <span class=md-ellipsis> Методи. @staticmethod, @classmethod </span> </a> </li> <li class=md-nav__item> <a href=#__subclasshook__ class=md-nav__link> <span class=md-ellipsis> Для чого метод __subclasshook__ ? </span> </a> </li> <li class=md-nav__item> <a href=#property class=md-nav__link> <span class=md-ellipsis> Що таке властивість (@property)? </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> Що таке дескриптор </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> Види дескрипторів </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> Методи дескрипторів </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> Проблеми, які можуть виникнути з дескрипторами </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Class and Object</h1> <h3 id=_1>Класи, об'єкти<a class=headerlink href=#_1 title="Permanent link">⚑</a></h3> <h4 id=_2>Клас<a class=headerlink href=#_2 title="Permanent link">⚑</a></h4> <p><strong>Клас</strong> - це структура даних в Python, яка дозволяє об'єднувати дані та функції, що з ними пов'язані, в одному об'єкті.</p> <ul> <li>Клас визначає атрибути (змінні) та методи (функції), які можна використовувати для маніпуляції цими атрибутами.</li> <li>Клас є шаблоном для створення об'єктів, тобто, він описує структуру об'єкта.</li> <li>Класи дозволяють використовувати концепцію наслідування для створення нових класів, які можуть успадковувати атрибути та методи від інших класів.</li> <li>В Python, всі речі є об'єктами, і класи є способом створення цих об'єктів. Клас створює об'єкт свого власного типу.</li> <li>Об'єкти зберігаються в хіпі - heap. А референси - в стеку.</li> <li>Змінна - референс - посилання на об'єкт.</li> </ul> <h4 id=_3>Від чого успадковуються класи і метакласи?<a class=headerlink href=#_3 title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p>Класи успадковуються від базового класу <code>object</code>, а метакласи - від базового метакласу <code>type</code>.</p> </blockquote> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>MyClass</span><span class=o>.</span><span class=n>__base__</span> <span class=o>==</span> <span class=nb>object</span>           <span class=c1># MyClass is a subclass of object.</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>MyMetaClass</span><span class=o>.</span><span class=n>__base__</span> <span class=o>==</span> <span class=nb>type</span>         <span class=c1># MyMetaClass is a subclass of type.</span>
</span></code></pre></div> <p>Всі класи в Python успадковуються від базового класу <code>object</code>. Це означає, що <code>object</code> є базовим класом для всіх класів у Python 3.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>   <span class=k>pass</span>
</span></code></pre></div> <p>Але можна не вказувати <code>object</code>, оскільки він є базовим класом за замовчуванням</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>   <span class=k>pass</span>
</span></code></pre></div> <p>Метаклас - це клас, який контролює створення і поведінку інших класів.</p> <p>Метакласи в Python успадковуються від базового метакласу <code>type</code>. </p> <p>Приклад створення метакласу, який додає атрибут до всіх класів</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>class</span><span class=w> </span><span class=nc>AddAttributeMeta</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>   <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>bases</span><span class=p>,</span> <span class=n>attrs</span><span class=p>):</span>      
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>       <span class=n>attrs</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;new&#39;</span>  <span class=c1># Add attribute &#39;status&#39; to the class</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>       <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>bases</span><span class=p>,</span> <span class=n>attrs</span><span class=p>)</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>AddAttributeMeta</span><span class=p>):</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>   <span class=k>pass</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=n>obj</span> <span class=o>=</span> <span class=n>MyClass</span><span class=p>()</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>status</span><span class=p>)</span>  <span class=c1># &quot;new&quot;</span>
</span></code></pre></div> <h4 id=__init__>Що робить метод <code>__init__</code>?<a class=headerlink href=#__init__ title="Permanent link">⚑</a></h4> <p>Метод <code>__init__</code> є конструктором класу в Python. Він автоматично викликається при створенні нового об'єкта або екземпляра класу і використовується для ініціалізації початкових значень атрибутів цього об'єкта. У методі <code>__init__</code> можна вказати параметри, які передаються при створенні об'єкта, і встановити їх як атрибути об'єкта. Це дозволяє підготувати об'єкт до подальшої роботи, встановити початкові стани та значення.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>class</span><span class=w> </span><span class=nc>Car</span><span class=p>:</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>brand</span><span class=p>):</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>color</span> <span class=o>=</span> <span class=n>color</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>brand</span> <span class=o>=</span> <span class=n>brand</span>
</span></code></pre></div> <h4 id=__new__-__init__>Що таке <code>__new__</code> і чим він відрізняється від <code>__init__</code>? У якій послідовності вони виконуються<a class=headerlink href=#__new__-__init__ title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p>Основна різниця між цими двома методами полягає в тому, що <code>__new__</code> обробляє створення об'єкта, а <code>__init__</code> обробляє його ініціалізацію.</p> </blockquote> <p><code>__new__</code> викликається автоматично при виклику імені класу (при створенні екземпляра), тоді як <code>__init__</code> викликається кожного разу, коли екземпляр класу повертається <code>__new__</code>, передаючи повернений екземпляр у <code>__init__</code> як параметр <code>self</code>. Тому навіть якщо зберегти екземпляр глобально/статично та повертати його кожного разу з <code>__new__</code>, для нього все одно кожного разу буде викликатися <code>__init__</code>.</p> <p>З цього випливає, що спочатку викликається <code>__new__</code>, а потім <code>__init__</code>.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>a</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=mi>1</span><span class=p>)</span> <span class=n>a</span> <span class=o>=</span> <span class=nb>object</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=n>A</span><span class=p>)</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=mi>2</span><span class=p>)</span> <span class=nb>object</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></code></pre></div> <h4 id=self-python>Що таке <code>self</code> в Python?<a class=headerlink href=#self-python title="Permanent link">⚑</a></h4> <p>У Python <code>self</code> - це ключове слово, яке використовується для визначення екземпляра або об'єкта класу. Тобто це посилання на поточний об'єкт або екземпляр класу. Використовується для доступу до атрибутів та методів об'єкта всередині класу. Ім'я <code>self</code> є конвенційним та може бути будь-яким, але зазвичай використовується саме <code>self</code> для читабельності коду.</p> <p>У методах класу, наприклад у методі <code>__init__</code>, <code>self</code> вказує на об'єкт, для якого викликається цей метод. У всіх інших методах він також передає посилання на об'єкт, який викликав цей метод, що дозволяє працювати з атрибутами та методами цього об'єкта. Іде першим параметром.</p> <p>Це допомагає уникнути плутанини між локальними змінними та атрибутами класу, і дозволяє зручно та однозначно звертатися до властивостей об'єкта всередині його методів.</p> <p><code>self</code> потрібно передати першим параметром, бо усі методи знаходяться в класі, а не в інстансі. Без нього клас не буде знати, до кого застосовувати метод.</p> <h4 id=_4>Як отримати список атрибутів об'єкта<a class=headerlink href=#_4 title="Permanent link">⚑</a></h4> <p>Функція <code>dir</code> повертає список рядків - полів об'єкта. Поле <code>__dict__</code> містить словник виду <code>{поле -&gt; значення}</code> (або ж викликати <code>vars</code>). <code>dir()</code> повертає список імен, включаючи всі доступні атрибути, включаючи вбудовані, тоді як <code>vars()</code> повертає лише атрибути, які були визначені в самому об'єкті.</p> <p>Є також геттери та сеттери для отримання доступу до атрибутів.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=o>&lt;</span><span class=nb>list</span><span class=o>&gt;</span> <span class=o>=</span> <span class=nb>dir</span><span class=p>(</span><span class=o>&lt;</span><span class=nb>object</span><span class=o>&gt;</span><span class=p>)</span>                     <span class=c1># Names of object&#39;s attributes (incl. methods).</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=o>&lt;</span><span class=nb>dict</span><span class=o>&gt;</span> <span class=o>=</span> <span class=nb>vars</span><span class=p>(</span><span class=o>&lt;</span><span class=nb>object</span><span class=o>&gt;</span><span class=p>)</span>                    <span class=c1># Dict of writable attributes. Also &lt;obj&gt;.__dict__.</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=o>&lt;</span><span class=nb>bool</span><span class=o>&gt;</span> <span class=o>=</span> <span class=nb>hasattr</span><span class=p>(</span><span class=o>&lt;</span><span class=nb>object</span><span class=o>&gt;</span><span class=p>,</span> <span class=s1>&#39;&lt;attr_name&gt;&#39;</span><span class=p>)</span>  <span class=c1># Checks if getattr() raises an AttributeError.</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=n>value</span>  <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=o>&lt;</span><span class=nb>object</span><span class=o>&gt;</span><span class=p>,</span> <span class=s1>&#39;&lt;attr_name&gt;&#39;</span><span class=p>)</span>  <span class=c1># Raises AttributeError if attribute is missing.</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=nb>setattr</span><span class=p>(</span><span class=o>&lt;</span><span class=nb>object</span><span class=o>&gt;</span><span class=p>,</span> <span class=s1>&#39;&lt;attr_name&gt;&#39;</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>    <span class=c1># Only works on objects with &#39;__dict__&#39; attribute.</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=nb>delattr</span><span class=p>(</span><span class=o>&lt;</span><span class=nb>object</span><span class=o>&gt;</span><span class=p>,</span> <span class=s1>&#39;&lt;attr_name&gt;&#39;</span><span class=p>)</span>           <span class=c1># Same. Also `del &lt;object&gt;.&lt;attr_name&gt;`.</span>
</span></code></pre></div> <h4 id=_5>Що таке магічні методи та для чого вони потрібні<a class=headerlink href=#_5 title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p><strong>Магічні методи (дандр методи, Magic methods, dundr methods)</strong> - це методи, імена яких починаються і закінчуються подвійним підкресленням. Магічні тому, що майже ніколи не викликаються явно. Їх викликають вбудовані функції або синтаксичні конструкції. Ці методи дозволяють налаштовувати поведінку об’єктів класу при взаємодії з іншими об’єктами або при виконанні певних операцій. Тобто вони дозволяють класам мати або перевизначити певну поведінку при виконанні різних операцій.</p> </blockquote> <p>Наприклад, функція <code>len()</code> викликає метод <code>__len__()</code> переданого об'єкта. Метод <code>__add__(self, other)</code> автоматично викликається при використанні оператора <code>+</code> для додавання.</p> <p>Найвживаніші магічні методи - <code>__init__</code> - конструктор класу. Приймає екземпляр класу. - <code>__new__</code> - приймає не instance, а об'єкт класу. Ініт вже приймає інстанс. Створює даний об'єкт, після цього на нього може відбуватись ініціалізація - <code>__class__</code> - визначає клас або тип, екземпляром якого являється об'єкт. Клас і тип - різні назви одного і того ж - <code>type(x) == x.__class__</code> - <code>__name__</code> - імя класу - <code>__str__, __repr__</code> - повертають рядкове представлення обєкту. repr - для девелопера, str - для прінта - <code>__getattr__</code> - використовується для обробки доступу до атрибутів, що не існують в об'єкті при доступі за допомогою точкової нотації <code>obj.&lt;attribute&gt;</code> - <code>__setattr__, __delattr__</code> - викликаються, якщо ми пробуємо взаємодіяти з атрибутом, якого немає в об'єкті - <code>__getattribute__</code> - викликається при спробі отримати значення атрибуту. Якщо цей метод перевизначений, стандартний механізм пошуку значень атрибутів не буде задіяний. - <code>__dict__</code> - сховище атрибутів, визначених користувачем. Пошук в ньому проводиться під час виконання і при пошуку враховується <code>__dict__</code> класу обєкту і базових класів. - <code>__bases__</code> - список прямих батьків - <code>__iter__</code> - повертає ітератор - <code>__eq__</code> - перевірка на рівність з іншим об'єктом - <code>__add__</code> - додавання до іншого об'єкта - <code>__call__</code> - дозволяє екземпляру класу поводитися як функція. Це означає, що об’єкт класу можна викликати як функцію з допомогою дужок - <code>__getitem__</code> - метод, який викликається, коли викликається при доступі за допомогою квадратних дужок <code>myobject[key]</code>, передаючи ключ або індекс (значення в квадратних дужках) як параметр. По послідовностях (списки, кортежі, рядки) можна ітеруватись, оскільки вони, реалізовуюсть метод <code>__getitem__</code> і <code>__len__</code> - <code>__len__</code> - повертає довжину послідовності - <code>__enter__</code>, <code>__exit__</code> - потрібні для реалізації менеджера контексту</p> <p>Найкращий спосіб правильно реалізувати ці методи (і перевірити набір методів, які потрібно реалізувати разом) — імплементувати базовий абстрактний клас, визначений в модулі <code>collections.abc</code> (<a href=https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes>https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes</a>). Ці інтерфейси надають методи, які потрібно реалізувати, а також подбають про правильне створення типу (коли функція <code>isinstance()</code> викликається для об’єкта).</p> <h4 id=__str__-__repr__>Яка різниця між <code>__str__</code> та <code>__repr__</code>?<a class=headerlink href=#__str__-__repr__ title="Permanent link">⚑</a></h4> <p><code>__str__</code> та <code>__repr__</code>- повертають рядкове представлення об'єкту. </p> <ul> <li><code>repr()</code> (representation) - повертає рядок, що представляє об'єкт у вигляді, зручному для розробника. Це те, що ми бачимо, коли об'єкт відображається на консолі Python або налагодженні. Щоб вивести для виводу об'єкт в його "представленні" (<code>__repr__</code>) у рядках форматування (f-strings), використовується спеціальний форматний ключ <code>!r</code>: <code>f"Object: {obj!r}"</code></li> <li><code>str()</code> (string) - повертає рядок, що представляє об'єкт у вигляді зручному для користувача. Це те, що друкує функція print(). Якщо не реалізований - то повертає <code>__repr__</code>. </li> </ul> <h4 id=__getattr__-__getattribute__>Яка різниця між <code>__getattr__</code> та <code>__getattribute__</code>?<a class=headerlink href=#__getattr__-__getattribute__ title="Permanent link">⚑</a></h4> <p>Метод <code>__getattr__</code> використовується для обробки доступу до атрибутів, які відсутні в об'єкті. Використовується для реалізації динамічного доступу до атрибутів.</p> <p>За допомогою магічного методу <code>__getattr__</code> можна контролювати спосіб отримання атрибутів з об’єктів. Коли ми викликаємо атрибут <code>&lt;myobject&gt;.&lt;myattribute&gt;</code>, Python шукатиме <code>&lt;myattribute&gt;</code> у словнику об’єкта, викликаючи на ньому <code>__getattribute__</code>. Якщо атрибут не знайдено (об’єкт не має атрибута, який ми шукаємо), то викликається додатковий метод, <code>__getattr__</code>, передаючи назву атрибута (myattribute) як параметр. Тобто, <code>__getattr__</code> викликається тільки в тому випадку, коли атрибут не існує, або якщо не знайдений в об'єкті. Якщо атрибут існує, то Python повертає його значення без виклику <code>__getattr__</code>.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>class</span><span class=w> </span><span class=nc>DynamicAttributes</span><span class=p>:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__getattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>  <span class=c1># This method will be called if the attribute does not exist</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>        <span class=k>if</span> <span class=n>name</span> <span class=o>==</span> <span class=s2>&quot;special_attribute&quot;</span><span class=p>:</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>            <span class=k>return</span> <span class=s2>&quot;This is a dynamically created attribute&quot;</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>            <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&#39; object has no attribute &#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=n>obj</span> <span class=o>=</span> <span class=n>DynamicAttributes</span><span class=p>()</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>special_attribute</span><span class=p>)</span>  <span class=c1># Accessing a non-existent attribute will call __getattr__</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=s2>&quot;This is a dynamically created attribute&quot;</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>some_other_attribute</span><span class=p>)</span>  <span class=c1># Accessing another non-existent attribute will raise an AttributeError</span>
</span></code></pre></div> <p>Для того, щоб <code>getattr()</code> правильно працював з <code>__getattr__</code>, він має викидати <code>AttributeError</code>. В іншому випадку <code>getattr</code> не поверне значення по замовчуванню, якщо атрибут відсутній.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nb>getattr</span><span class=p>(</span><span class=n>obj</span><span class=p>,</span> <span class=s2>&quot;something&quot;</span><span class=p>,</span> <span class=s2>&quot;default&quot;</span><span class=p>)</span>  <span class=c1># &quot;default&quot;</span>
</span></code></pre></div> <p>Важливо пам'ятати, що метод <code>__getattr__</code> не викликається для атрибутів, які існують в об'єкті. Якщо ви хочете перехоплювати доступ до всіх атрибутів, включаючи ті, що вже існують, потрібно використовувати метод <code>__getattribute__</code>.</p> <h4 id=__qualname__>Метод <code>__qualname__</code><a class=headerlink href=#__qualname__ title="Permanent link">⚑</a></h4> <p><code>__qualname__</code> (qualified name) використовується для того, щоб вказати повне ім'я об'єкта (зокрема, функції, класу чи методу) у контексті його вкладеності. Це допомагає ідентифікувати об'єкт у його ієрархії.</p> <p>Наприклад, якщо є вкладені класи або методи, <code>__qualname__</code> покаже повну структуру, де знаходиться цей об'єкт (на відміну від <code>__name__</code>, який дає лише коротке ім'я об'єкта).</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>class</span><span class=w> </span><span class=nc>Outer</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=k>class</span><span class=w> </span><span class=nc>Inner</span><span class=p>:</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>        <span class=k>def</span><span class=w> </span><span class=nf>method</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>            <span class=k>pass</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=nb>print</span><span class=p>(</span><span class=n>Outer</span><span class=o>.</span><span class=n>Inner</span><span class=o>.</span><span class=n>method</span><span class=o>.</span><span class=vm>__qualname__</span><span class=p>)</span>  <span class=c1># Outer.Inner.method</span>
</span></code></pre></div> <h4 id=super>Як у класі посилатися на батьківський клас (<code>super()</code>)<a class=headerlink href=#super title="Permanent link">⚑</a></h4> <p>Функція <code>super()</code> використовується як метод для створення об'єкта-проксі який дозволяє доступитися до методів батьківського класу. Цей об'єкт-проксі забезпечує механізм динамічного зв'язування і дозволяє викликати методи батьківського класу з поточного класу та отримувати доступ до його атрибутів.</p> <p>Конкретний об'єкт, який повертає <code>super()</code>, залежить від контексту виклику. Він представляє наступний клас у ланцюжку успадкування (методи якого можуть бути викликані) після поточного класу.</p> <p>При виклику методу через <code>super()</code>, контекст виклику передається батьківському методу, що дозволяє коректно обробляти дані відповідно до правил успадкування.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>class</span><span class=w> </span><span class=nc>NextClass</span><span class=p>(</span><span class=n>FirstClass</span><span class=p>):</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
</span></code></pre></div> <p>Найчастіше <code>super()</code> використовується для магічних методів. Наприклад, щоб викликати <code>__init__()</code> батьківського класу.</p> <h4 id=_6>Чи можливе множинне наслідування<a class=headerlink href=#_6 title="Permanent link">⚑</a></h4> <p>Так, в класах в Python можна вказати більше одного батька для похідного класу. На відміну від, наприклад, Java.</p> <h4 id=mro>Що таке MRO<a class=headerlink href=#mro title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p><strong>MRO (Method Resolution Order)</strong> - порядок вирішення методу. Це алгоритм пошуку методу в разі, якщо у класу є два або більше батьків.</p> </blockquote> <p>При успадкуванні класів нового стилю застосовується правило MRO (порядок вирішення методів), тобто лінійний обхід дерева класів, при цьому вкладений елемент успадкування стає доступним у атрибуті <code>__mro__</code> даного класу. Такий алгоритм називається C3-лініаризація. Наслідування за правилом MRO здійснюється приблизно за наступним порядком.</p> <ol> <li>Перерахування всіх класів, успадкованих екземпляром, за правилом пошуку DFLR для класичних класів, причому клас включається в результат пошуку стільки разів, скільки він зустрічається при обході.</li> <li>Перегляд у отриманому списку дублікатів класів, з яких видаляються всі, крім останнього (останнього справа) дубліката в списку.</li> </ol> <p>Обхід у глибину та зліва направо - DFLR 1. Спочатку екземпляр 2. Потім його клас 3. Далі всі суперкласи його класу з обходом спочатку у глибину, а потім зліва направо 4. Використовується перше знайдене входження.</p> <p>Упорядкування за правилом MRO застосовується при успадкуванні та виклику вбудованої функції <code>super()</code>, яка завжди викликає наступний клас за правилом MRO (відносно точки виклику).</p> <p>Приклад успадкування в не-ромбовидних ієрархічних деревах</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>class</span><span class=w> </span><span class=nc>D</span><span class=p>:</span>          <span class=n>attr</span> <span class=o>=</span> <span class=mi>3</span>      <span class=c1>#  D:3   E:2</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=k>class</span><span class=w> </span><span class=nc>B</span><span class=p>(</span><span class=n>D</span><span class=p>):</span>       <span class=k>pass</span>          <span class=c1>#   |     |</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=k>class</span><span class=w> </span><span class=nc>E</span><span class=p>:</span>          <span class=n>attr</span> <span class=o>=</span> <span class=mi>2</span>      <span class=c1>#   B    C:1</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=k>class</span><span class=w> </span><span class=nc>C</span><span class=p>(</span><span class=n>E</span><span class=p>):</span>       <span class=n>attr</span> <span class=o>=</span> <span class=mi>1</span>      <span class=c1>#    \   /</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=k>class</span><span class=w> </span><span class=nc>A</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>):</span>    <span class=k>pass</span>          <span class=c1>#      A</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=n>X</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>                         <span class=c1>#      |</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=nb>print</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>attr</span><span class=p>)</span>                   <span class=c1>#      X</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=o>&gt;&gt;&gt;</span> <span class=n>DFLR</span> <span class=o>=</span> <span class=p>[</span><span class=n>X</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>D</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>E</span><span class=p>]</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=o>&gt;&gt;&gt;</span> <span class=n>MRO</span> <span class=o>=</span> <span class=p>[</span><span class=n>X</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>D</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>E</span><span class=p>,</span> <span class=nb>object</span><span class=p>]</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=o>&gt;&gt;&gt;</span> <span class=n>Outputs</span> <span class=n>string</span> <span class=s2>&quot;3&quot;</span>
</span></code></pre></div> <p>Приклад успадкування в ромбовидних ієрархічних деревах</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>class</span><span class=w> </span><span class=nc>D</span><span class=p>:</span>          <span class=n>attr</span> <span class=o>=</span> <span class=mi>3</span>      <span class=c1>#     D:3   </span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=k>class</span><span class=w> </span><span class=nc>B</span><span class=p>(</span><span class=n>D</span><span class=p>):</span>       <span class=k>pass</span>          <span class=c1>#    /   \</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=k>class</span><span class=w> </span><span class=nc>C</span><span class=p>(</span><span class=n>D</span><span class=p>):</span>       <span class=n>attr</span> <span class=o>=</span> <span class=mi>1</span>      <span class=c1>#   B   C:1</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=k>class</span><span class=w> </span><span class=nc>A</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>):</span>    <span class=k>pass</span>          <span class=c1>#    \   /</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>X</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>                         <span class=c1>#      A</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=nb>print</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>attr</span><span class=p>)</span>                   <span class=c1>#      |</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=o>...</span>                             <span class=c1>#      X</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=o>&gt;&gt;&gt;</span> <span class=n>DFLR</span> <span class=o>=</span> <span class=p>[</span><span class=n>X</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>D</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>D</span><span class=p>]</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=o>&gt;&gt;&gt;</span> <span class=n>MRO</span> <span class=o>=</span> <span class=p>[</span><span class=n>X</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>D</span><span class=p>,</span> <span class=nb>object</span><span class=p>]</span> <span class=p>(</span><span class=n>keeps</span> <span class=n>only</span> <span class=n>the</span> <span class=n>last</span> <span class=n>duplicate</span> <span class=n>D</span><span class=p>)</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=o>&gt;&gt;&gt;</span> <span class=n>Outputs</span> <span class=n>string</span> <span class=s2>&quot;1&quot;</span>
</span></code></pre></div> <h4 id=diamond-problem>Що таке проблема ромба (Diamond problem)<a class=headerlink href=#diamond-problem title="Permanent link">⚑</a></h4> <p>При ромбовидному успадкуванні потрібно визначити, який метод класу слід викликати. У Python вирішується за допомогою MRO.</p> <p>Приклад успадкування в ромбовидних ієрархічних деревах</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>class</span><span class=w> </span><span class=nc>D</span><span class=p>:</span>          <span class=n>attr</span> <span class=o>=</span> <span class=mi>3</span>      <span class=c1>#     D:3   </span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=k>class</span><span class=w> </span><span class=nc>B</span><span class=p>(</span><span class=n>D</span><span class=p>):</span>       <span class=k>pass</span>          <span class=c1>#    /   \</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=k>class</span><span class=w> </span><span class=nc>C</span><span class=p>(</span><span class=n>D</span><span class=p>):</span>       <span class=n>attr</span> <span class=o>=</span> <span class=mi>1</span>      <span class=c1>#   B   C:1</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=k>class</span><span class=w> </span><span class=nc>A</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>):</span>    <span class=k>pass</span>          <span class=c1>#    \   /</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=n>X</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>                         <span class=c1>#      A</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=nb>print</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>attr</span><span class=p>)</span>                   <span class=c1>#      |</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=o>...</span>                             <span class=c1>#      X</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=o>&gt;&gt;&gt;</span> <span class=n>DFLR</span> <span class=o>=</span> <span class=p>[</span><span class=n>X</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>D</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>D</span><span class=p>]</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=o>&gt;&gt;&gt;</span> <span class=n>MRO</span> <span class=o>=</span> <span class=p>[</span><span class=n>X</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>,</span> <span class=n>D</span><span class=p>,</span> <span class=nb>object</span><span class=p>]</span> <span class=p>(</span><span class=n>keeps</span> <span class=n>only</span> <span class=n>the</span> <span class=n>last</span> <span class=n>duplicate</span> <span class=n>D</span><span class=p>)</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=o>&gt;&gt;&gt;</span> <span class=n>Outputs</span> <span class=n>string</span> <span class=s2>&quot;1&quot;</span>
</span></code></pre></div> <h4 id=_7>Що таке міксіни?<a class=headerlink href=#_7 title="Permanent link">⚑</a></h4> <p><strong>Міксін (mix-in, примішання)</strong> - це шаблон проектування в ООП, коли до ланцюжка успадкування додається невеликий допоміжний клас. </p> <p>Наприклад, є клас</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=k>class</span><span class=w> </span><span class=nc>NowMixin</span><span class=p>:</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>    <span class=k>def</span><span class=w> </span><span class=nf>now</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>        <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></code></pre></div> <p>Тоді будь-який клас, успадкований з цим міксіном, матиме метод <code>now()</code>.</p> <p>У назвах міксінів зазвичай додають слово <code>Mixin</code>, оскільки не існує жодного механізму для розрізнення повноцінного класу і міксіна. Міксін технічно є звичайним класом.</p> <p>Проте загалом, краще використовувати композицію, ніж наслідування, оскільки останнє призводить до певних проблем, таких як збільшення зв'язності компонентів коду. Використання наслідування (через клас mixin) у даному прикладі є досить вигаданим. Наслідування не використовується для створення більш спеціалізованої версії класу, а лише для того, щоб скористатися методом <code>now()</code>. Це було б погано з двох причин: по-перше, наслідування - не найкращий спосіб повторного використання коду. Хороший код повторно використовується через створення невеликих, узгоджених абстракцій, а не через побудову ієрархій. По-друге, створення підкласу повинно відповідати ідеї спеціалізації, відношення типу "is a".</p> <p>Щоб прояснити цей другий момент допоможе ієрархія наступного типу</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=k>class</span><span class=w> </span><span class=nc>Connection</span><span class=p>:</span> <span class=o>...</span>  
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=k>class</span><span class=w> </span><span class=nc>EncryptedConnection</span><span class=p>(</span><span class=n>Connection</span><span class=p>):</span> <span class=o>...</span>  
</span></code></pre></div> <p>У цьому випадку використання наслідування можна вважати правильним, адже зашифроване з'єднання є більш специфічним видом з'єднання. Тому якщо можна уникнути такої суто службової абстракції, то краще замінити її чимось.</p> <p><em>Links</em></p> <ul> <li><a href=https://www.amazon.com/Clean-Code-Python-maintainable-efficient/dp/1800560214>Clean code in Python: develop maintainable and efficient code - Mariano Anaya</a></li> </ul> <h4 id=_8>Абстрактні класи та методи<a class=headerlink href=#_8 title="Permanent link">⚑</a></h4> <p>Абстрактні класи та методи в Python забезпечують механізм визначення шаблону для класів-нащадків, змушуючи їх реалізовувати певний набір методів. Вони є ключовим елементом для забезпечення інтерфейсу та дотримання принципів об'єктно-орієнтованого програмування, таких як поліморфізм.</p> <p><strong>Абстрактний клас</strong> — це клас, який не можна створити напряму. Він використовується як базовий клас для інших. У Python абстрактні класи визначаються за допомогою модуля <code>abc</code> (Abstract Base Classes).</p> <p><strong>Абстрактний метод</strong> — це метод, який визначений у базовому абстрактному класі, але не має реалізації. Класи-нащадки зобов’язані реалізувати всі абстрактні методи, інакше їх не можна створити. Для визначення абстрактного методу використовується декоратор <code>@abstractmethod</code>. Абстрактні методи оголошуються всередині абстрактного класу.</p> <p>Абстрактні класи та методи допомагають створювати інтерфейси та структури для класів, які мають схожу поведінку.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span><span class=w> </span><span class=nn>abc</span><span class=w> </span><span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=k>class</span><span class=w> </span><span class=nc>Shape</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>  <span class=c1># Abstract class</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>    <span class=k>def</span><span class=w> </span><span class=nf>area</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Calculate the area of the shape.&quot;&quot;&quot;</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>        <span class=k>pass</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>perimeter</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Calculate the perimeter of the shape.&quot;&quot;&quot;</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>        <span class=k>pass</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=k>class</span><span class=w> </span><span class=nc>Rectangle</span><span class=p>(</span><span class=n>Shape</span><span class=p>):</span>  <span class=c1># Subclass implementing the abstract methods</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>):</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=n>width</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>        <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=n>height</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>    <span class=k>def</span><span class=w> </span><span class=nf>area</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>height</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>    <span class=k>def</span><span class=w> </span><span class=nf>perimeter</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>        <span class=k>return</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>height</span><span class=p>)</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=n>shape</span> <span class=o>=</span> <span class=n>Shape</span><span class=p>()</span>  <span class=c1># Raises TypeError: Can&#39;t instantiate abstract class</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=n>rect</span> <span class=o>=</span> <span class=n>Rectangle</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Area:&quot;</span><span class=p>,</span> <span class=n>rect</span><span class=o>.</span><span class=n>area</span><span class=p>())</span>  <span class=c1># Output: Area: 20</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Perimeter:&quot;</span><span class=p>,</span> <span class=n>rect</span><span class=o>.</span><span class=n>perimeter</span><span class=p>())</span>  <span class=c1># Output: Perimeter: 18</span>
</span></code></pre></div> <h4 id=object-object>Чому рівний вираз <code>object() == object()</code><a class=headerlink href=#object-object title="Permanent link">⚑</a></h4> <p>Завжди неправда, оскільки за замовчуванням об'єкти порівнюються за полем id (адресою в пам'яті), якщо тільки не перевизначений метод <code>__eq__</code>.</p> <h4 id=__slots__><code>__slots__</code><a class=headerlink href=#__slots__ title="Permanent link">⚑</a></h4> <p>Класи зберігають поля та їх значення у прихованому словнику <code>__dict__</code>. Оскільки словник є змінною структурою, можна додавати та видаляти поля класу в будь-який момент. Параметр <code>__slots__</code> у класі жорстко фіксує набір полів класу. Слоти використовуються, коли клас може мати дуже багато полів, наприклад, в деяких ORM або коли критична продуктивність, оскільки доступ до слоту відбувається швидше, ніж пошук у словнику, або коли в процесі виконання програми створюється мільйони екземплярів класу, застосування <code>__slots__</code> дозволить економити пам'ять.</p> <p>Слоти активно використовуються в бібліотеці <code>requests</code>.</p> <p>Мінуси: не можна присвоїти класу поле, якого немає в слотах. Не працюють методи <code>__getattr__</code> і <code>__setattr__</code>. Рішення: включити в <code>__slots__</code> елемент <code>__dict__</code>.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=k>class</span><span class=w> </span><span class=nc>Person</span><span class=p>:</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>    <span class=vm>__slots__</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>)</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>age</span><span class=p>):</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=n>age</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=n>person</span> <span class=o>=</span> <span class=n>Person</span><span class=p>(</span><span class=s2>&quot;John&quot;</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=k>try</span><span class=p>:</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>    <span class=n>person</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=s2>&quot;New York&quot;</span>  <span class=c1># This will raise an AttributeError</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=k>except</span> <span class=ne>AttributeError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Error:&quot;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=n>person</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;Alice&quot;</span>  <span class=c1># Setting values for attributes defined in __slots__</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=n>person</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=mi>25</span>
</span></code></pre></div> <p>Під капотом це реалізується за допомогою дескрипторів. Оскільки атрибуту <code>__dict__</code> для зберігання значень змінних екземпляра немає, Python замість цього створює дескриптор для кожного слоту та зберігає значення там. Це має побічний ефект: ми не можемо змішувати атрибути класу з атрибутами екземпляра (наприклад, використання атрибута класу як значення за замовчуванням для атрибута екземпляра неможливо, тому що значення будуть перезаписані).</p> <h4 id=_value-__value>Атрибути. В чому сенс <code>_value</code>, <code>__value</code><a class=headerlink href=#_value-__value title="Permanent link">⚑</a></h4> <p><strong>Атрибути</strong> - це змінні класу. Можуть бути атрибути класу або атрибути інстансу. Атрибути класу спільні для всіх інстансів.</p> <p>3 типи атрибутів - Публічні - public - <code>a = 1</code> - не мають обмежень за доступом і можуть бути доступні з будь-якого місця програми. - Захищені - protected - <code>_a = 1</code> - змінна чи метод не призначені для використання поза методами класу, однак атрибут доступний по цьому імені. - Приватні - private - <code>__a = 1</code> - ззовні недоступний по цьому імені, тільки всередині. Але все-одно буде доступний під ім'ям <code>a._ClassName__a</code>.</p> <p><strong>Public</strong> Атрибути і методи, доступні ззовні класу.</p> <p><strong>Privat</strong> Поле класу з одним ведучим підкресленням вказує на те, що параметр використовується тільки всередині класу. При цьому воно доступне для звернення ззовні. Це обмеження доступу тільки на рівні угоди.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=k>class</span><span class=w> </span><span class=nc>Foo</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_bar</span> <span class=o>=</span> <span class=mi>42</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=n>Foo</span><span class=p>()</span><span class=o>.</span><span class=n>_bar</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>42</span>
</span></code></pre></div> <p>Сучасні IDE, наприклад <code>PyCharm</code>, виділять звернення до поля з підкресленням, але це не призведе до помилки в процесі виконання.</p> <p><strong>Protected</strong> Поля з подвійним підкресленням доступні всередині класу, але недоступні ззовні та недоступні нащадкам. Це досягається наступним прийомом: інтерпретатор присвоює таким полям імена у вигляді <code>_&lt;ClassName&gt;__&lt;fieldName&gt;</code>. Описаний механізм називається name mangling або name decoration.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=k>class</span><span class=w> </span><span class=nc>Parent</span><span class=p>():</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>__foo</span> <span class=o>=</span> <span class=mi>42</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=k>class</span><span class=w> </span><span class=nc>Child</span><span class=p>(</span><span class=n>Parent</span><span class=p>):</span> 
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span> 
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=n>Parent</span><span class=p>()</span><span class=o>.</span><span class=n>__foo</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=o>&gt;&gt;&gt;</span> <span class=ne>AttributeError</span><span class=p>:</span> <span class=s1>&#39;Parent&#39;</span> <span class=nb>object</span> <span class=n>has</span> <span class=n>no</span> <span class=n>attribute</span> <span class=s1>&#39;__foo&#39;</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=n>Parent</span><span class=p>()</span><span class=o>.</span><span class=n>_Parent__foo</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>42</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=n>Child</span><span class=p>()</span><span class=o>.</span><span class=n>_Parent__foo</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>42</span>
</span></code></pre></div> <h4 id=_9>Що таке качина типізація<a class=headerlink href=#_9 title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p><strong>Качина типізація (Duck typing)</strong> - вид динамічної типізації, коли межі використання об'єкту визначаються його поточним набором методів і властивостей, на відміну від успадкування від певного класу.</p> </blockquote> <p>Іншими словами, вважається, що об'єкт реалізує інтерфейс, якщо він містить всі методи цього інтерфейсу, незалежно від зв'язків у ієрархії успадкування та належності до якого-небудь конкретного класу.</p> <p>Синоніми - неявна типізація, латентна типізація. Застосовуваної в таких мовах програмування - Perl, Smalltalk, Python, Objective-C, Ruby, JavaScript, Groovy, ColdFusion, Boo, Lua, Go, C#. </p> <p>Назва терміна походить від англійського «duck test» («качиний тест»), який в оригіналі звучить так: «If it looks like a duck, swims like a duck and quacks like a duck, then it probably is a duck». («Якщо воно виглядає як качка, плаває як качка і крякає як качка, то це напевно і є качка»).</p> <h4 id=overloading>Що таке перевантаження оператора (overloading)?<a class=headerlink href=#overloading title="Permanent link">⚑</a></h4> <p><strong>Overloading (перевантаження) оператора</strong> - це можливість змінювати поведінку вбудованих операторів (<code>+, -, *</code>) в своєму класі . Це досягається за допомогою спеціальних методів в класах, які визначають, як оператори мають взаємодіяти з об'єктами цього класу.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>class</span><span class=w> </span><span class=nc>Vector</span><span class=p>:</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>    <span class=k>def</span><span class=w> </span><span class=fm>__add__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>        <span class=n>sum_x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>+</span> <span class=n>other</span><span class=o>.</span><span class=n>x</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>        <span class=n>sum_y</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>+</span> <span class=n>other</span><span class=o>.</span><span class=n>y</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>        <span class=k>return</span> <span class=n>Vector</span><span class=p>(</span><span class=n>sum_x</span><span class=p>,</span> <span class=n>sum_y</span><span class=p>)</span>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=n>v1</span> <span class=o>=</span> <span class=n>Vector</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=n>v2</span> <span class=o>=</span> <span class=n>Vector</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=n>result</span> <span class=o>=</span> <span class=n>v1</span> <span class=o>+</span> <span class=n>v2</span>
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;(</span><span class=si>{0}</span><span class=s2>, </span><span class=si>{1}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>result</span><span class=o>.</span><span class=n>y</span><span class=p>))</span>  <span class=c1># (4, 6)</span>
</span></code></pre></div> <p>У цьому прикладі метод <code>__add__</code> перевантажено для класу <code>Vector</code>, що дозволяє об'єктам цього класу використовувати оператор <code>+</code> для додавання векторів.</p> <h4 id=type>Як створити клас з допомогою <code>type()</code><a class=headerlink href=#type title="Permanent link">⚑</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=nb>type</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>bases</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=o>**</span><span class=n>kwds</span><span class=p>)</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>class</span><span class=w> </span><span class=nc>X</span><span class=p>:</span>  <span class=c1># using class keyword</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>    <span class=o>...</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=k>class</span><span class=w> </span><span class=nc>Y</span><span class=p>(</span><span class=n>X</span><span class=p>):</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>    <span class=n>a</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=n>Y</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=s1>&#39;Y&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>X</span><span class=p>,),</span> <span class=nb>dict</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>  <span class=c1># using type()</span>
</span></code></pre></div> <p>Перший аргумент вказує ім'я класу, другий - кортеж базових класів - <code>(X,)</code>, а третій - словник атрибутів класу.</p> <h4 id=staticmethod-classmethod>Методи. <code>@staticmethod</code>, <code>@classmethod</code><a class=headerlink href=#staticmethod-classmethod title="Permanent link">⚑</a></h4> <p><strong>Метод</strong> - це функція, яка викликається від інстансу класу. Метод зберігаються в класі, а не інстансі. Використовує параметр <code>self</code>, який представляє екземпляр класу. </p> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>    <span class=k>def</span><span class=w> </span><span class=nf>instance_method</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Instance method called. Attribute: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>attribute</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>obj</span> <span class=o>=</span> <span class=n>MyClass</span><span class=p>()</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=n>obj</span><span class=o>.</span><span class=n>attribute</span> <span class=o>=</span> <span class=mi>5</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>instance_method</span><span class=p>())</span>  <span class=c1># Output: Instance method called. Attribute: 5</span>
</span></code></pre></div> <p>Оскільки функції реалізують протокол дескриптора (реалізують метод <code>__get__</code>), перед викликом методу спочатку викликається метод <code>__get__()</code>. Це перетворює функцію на метод, що означає прив'язку викликаного до екземпляра об'єкту, з яким він збирається працювати. </p> <p>Це можна імітувати за допомогою <code>MethodType</code> із модуля <code>types</code>. Перший параметр цього класу має бути <code>callable</code>, а другий — це об'єкт, до якого прив'язується ця функція. Щось подібне до цього використовують об'єкти функцій у Python, щоб вони могли працювати як методи, коли їх визначають всередині класу. У цьому прикладі абстракція <code>MyClass</code> намагається імітувати об'єкт функції, оскільки в реальному інтерпретаторі це реалізовано на C.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=kn>from</span><span class=w> </span><span class=nn>types</span><span class=w> </span><span class=kn>import</span> <span class=n>MethodType</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=k>class</span><span class=w> </span><span class=nc>Method</span><span class=p>:</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=k>def</span><span class=w> </span><span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>arg1</span><span class=p>,</span> <span class=n>arg2</span><span class=p>):</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>instance</span><span class=si>}</span><span class=s2> called with </span><span class=si>{</span><span class=n>arg1</span><span class=si>}</span><span class=s2> and </span><span class=si>{</span><span class=n>arg2</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>    <span class=k>def</span><span class=w> </span><span class=fm>__get__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>owner</span><span class=p>):</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>        <span class=k>if</span> <span class=n>instance</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>            <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>        <span class=k>return</span> <span class=n>MethodType</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>)</span>
</span></code></pre></div> <p>3 типи методів - метод інстансу - тільки від інстансу. Якщо від класу - помилка. Перший параметр - інстанс <code>self</code>. Цей метод має доступ до атрибутів і методів екземпляра. - метод класу <code>@classmethod</code> - першим параметром приймає клас <code>cls</code>. Може викликатись як від інстансу, так і від класу. - статичний метод <code>@staticmethod</code> </p> <p>І <code>@staticmethod</code>, і <code>@classmethod</code> реалізовані за допомогою дескриптора.</p> <p><code>@staticmethod</code> Статичний метод не використовує <code>self</code> або <code>cls</code>. Він не має доступу до атрибутів екземпляра або класу. Це по суті функція всередині класу.</p> <p>Функція <code>__get__</code> забезпечує, що жодні параметри не прив'язуються, окрім тих, які визначені самою функцією. Іншими словами, вона скасовує прив'язку, здійснену методом <code>__get__()</code> для функцій, які роблять <code>self</code> першим параметром цієї функції.</p> <p>Коли використовувати: - Коли метод не потребує доступу до екземпляра або класу. - Коли метод логічно зв'язаний з класом, але не використовує його атрибути або методи.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>    <span class=k>def</span><span class=w> </span><span class=nf>static_method</span><span class=p>():</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>        <span class=k>return</span> <span class=s2>&quot;Static method called&quot;</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=nb>print</span><span class=p>(</span><span class=n>MyClass</span><span class=o>.</span><span class=n>static_method</span><span class=p>())</span>  <span class=c1># Output: Static method called</span>
</span></code></pre></div> <p><code>@classmethod</code> Метод класу приймає параметр <code>cls</code>, який представляє сам клас. Це дозволяє методам класу доступ до атрибутів і методів класу. </p> <p>Функція <code>__get__</code> у дескрипторі забезпечує, що клас передається як перший параметр до функції, яка декорується, незалежно від того, викликається вона безпосередньо з класу чи через екземпляр. </p> <p>Якщо потрібно ще щось перекласти чи пояснити, дайте знати! 😊</p> <p>Коли використовувати: - Коли метод повинен працювати з класом як з об'єктом. - Коли потрібно створити метод, що працює з загальними для всіх екземплярів даними.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>    <span class=n>class_attribute</span> <span class=o>=</span> <span class=s2>&quot;Class attribute&quot;</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>    <span class=nd>@classmethod</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>    <span class=k>def</span><span class=w> </span><span class=nf>class_method</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Class method called. Attribute: </span><span class=si>{</span><span class=bp>cls</span><span class=o>.</span><span class=n>class_attribute</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=nb>print</span><span class=p>(</span><span class=n>MyClass</span><span class=o>.</span><span class=n>class_method</span><span class=p>())</span>  <span class=c1># Output: Class method called. Attribute: Class attribute</span>
</span></code></pre></div> <h4 id=__subclasshook__>Для чого метод <code>__subclasshook__</code> ?<a class=headerlink href=#__subclasshook__ title="Permanent link">⚑</a></h4> <p>Метод <code>__subclasshook__</code> використовується для перевірки, чи є клас підкласом певного класу. Цей метод є частиною механізму метакласів і надає можливість контролювати спадкування класів.</p> <p>Коли викликається метод <code>issubclass(cls, C)</code>, де <code>cls</code> - поточний клас, а C - потенційний батьківський клас, Python спочатку перевіряє, чи є метод <code>__subclasshook__</code> в <code>cls</code>. Якщо такий метод існує, він викликається з двома аргументами: класом <code>cls</code> і класом C. </p> <p>Метод <code>__subclasshook__</code> повинен повернути True, якщо клас <code>cls</code> є підкласом класу C.</p> <p>Метод <code>__subclasshook__</code> можна використовувати для встановлення спеціальних вимог щодо спадкування. Наприклад, можна використовувати його, щоб перевірити, чи має підклас певні атрибути або методи, які необхідні для коректної роботи з певним інтерфейсом або механізмом.</p> <h4 id=property>Що таке властивість (<code>@property</code>)?<a class=headerlink href=#property title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p><strong>Property (властивість)</strong> - це спеціальний метод класу, який дозволяє контролювати доступ до атрибутів об'єкта, коли вони читаються, записуються або видаляються. Property використовується для забезпечення контрольованого доступу до даних об'єкта. Реалізується з допомогою декоратора <code>@property</code>.</p> </blockquote> <p>Property дозволяє викликати метод як атрибут і всередині заховати складну логіку (точкова нотація). Або коли змінюється логіка всередині, щоб не міняти API.</p> <p>Метод <code>property()</code> приймає на вхід методи <code>get</code>, <code>set</code> и <code>delete</code>, і повертає об'єкти класу <code>property</code>.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nb>property</span><span class=p>(</span><span class=n>fget</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fset</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fdel</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>doc</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=k>class</span><span class=w> </span><span class=nc>Circle</span><span class=p>:</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>radius</span><span class=p>):</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_radius</span> <span class=o>=</span> <span class=n>radius</span>  <span class=c1># Attribute with an underscore is a protected attribute</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>    <span class=nd>@property</span>  <span class=c1># Getter to retrieve the radius value</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=k>def</span><span class=w> </span><span class=nf>radius</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>  
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_radius</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>    <span class=nd>@radius</span><span class=o>.</span><span class=n>setter</span>  <span class=c1># Setter to set the radius value</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>    <span class=k>def</span><span class=w> </span><span class=nf>radius</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>        <span class=k>if</span> <span class=n>value</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Radius cannot be negative&quot;</span><span class=p>)</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_radius</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>    <span class=nd>@radius</span><span class=o>.</span><span class=n>deleter</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>    <span class=k>def</span><span class=w> </span><span class=nf>radius</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>_radius</span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>    <span class=nd>@property</span>  <span class=c1># Getter to compute the area of the circle</span>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a>    <span class=k>def</span><span class=w> </span><span class=nf>area</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a>        <span class=k>return</span> <span class=mf>3.14159</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>_radius</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>_radius</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a><span class=n>circle</span> <span class=o>=</span> <span class=n>Circle</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a><span class=nb>print</span><span class=p>(</span><span class=n>circle</span><span class=o>.</span><span class=n>radius</span><span class=p>)</span>  <span class=c1># Output: 5</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a><span class=n>circle</span><span class=o>.</span><span class=n>radius</span> <span class=o>=</span> <span class=mi>7</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a><span class=nb>print</span><span class=p>(</span><span class=n>circle</span><span class=o>.</span><span class=n>radius</span><span class=p>)</span>  <span class=c1># Output: 7</span>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a><span class=nb>print</span><span class=p>(</span><span class=n>circle</span><span class=o>.</span><span class=n>area</span><span class=p>)</span>    <span class=c1># Output: 153.93845</span>
</span></code></pre></div> <p>Декоратори <code>@property</code> і <code>@radius.setter</code> створюють property для атрибута <code>radius</code>. Property <code>radius</code> дозволяє отримувати і змінювати значення радіусу об'єкта <code>circle</code>. </p> <p>Приблизна реалізація <code>property()</code> за допомогою протоколу дескрипторів</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>class</span><span class=w> </span><span class=nc>Property</span><span class=p>:</span>  
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>fget</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fset</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fdel</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>doc</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>  
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fget</span> <span class=o>=</span> <span class=n>fget</span>  
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fset</span> <span class=o>=</span> <span class=n>fset</span>  
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fdel</span> <span class=o>=</span> <span class=n>fdel</span>  
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>        <span class=bp>self</span><span class=o>.</span><span class=vm>__doc__</span> <span class=o>=</span> <span class=n>doc</span>  
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>    <span class=k>def</span><span class=w> </span><span class=fm>__get__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>obj</span><span class=p>,</span> <span class=n>objtype</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>  
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>        <span class=k>if</span> <span class=n>obj</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>            <span class=k>return</span> <span class=bp>self</span>  
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fget</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a>            <span class=k>raise</span> <span class=ne>AttributeError</span>  
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fget</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>  
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>obj</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>  
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fset</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a>            <span class=k>raise</span> <span class=ne>AttributeError</span>  
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a>
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fset</span><span class=p>(</span><span class=n>obj</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>  
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a>
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a>    <span class=k>def</span><span class=w> </span><span class=fm>__delete__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>obj</span><span class=p>):</span>  
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>fdel</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a>            <span class=k>raise</span> <span class=ne>AttributeError</span>  
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a>
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a>        <span class=bp>self</span><span class=o>.</span><span class=n>fdel</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
</span></code></pre></div> <h4 id=_10>Що таке дескриптор<a class=headerlink href=#_10 title="Permanent link">⚑</a></h4> <p><em>Summary</em></p> <blockquote> <p><strong>Дескриптор</strong> - будь-який об'єкт, який імплементує протокол дескриптора - визначає хоча б один з методів <code>__get__()</code>, <code>__set__()</code> або <code>__delete__()</code>.</p> </blockquote> <p>Додатково дескриптори можуть мати метод <code>__set_name__()</code>. Це використовується лише у випадках, коли дескриптору потрібно знати або клас, у якому він був створений, або назву змінної класу, якій він був призначений.</p> <p>Дескриптор дозволяє контролювати доступ, присвоєння і видалення атрибутів об'єктів, замість використання звичайних методів доступу.</p> <p>Дескриптори використовуються у вбудованих механізмах Python</p> <ul> <li>Декоратор <code>@property</code> є дескриптором, який реалізує повний протокол дескриптора для визначення своїх дій <code>get</code>, <code>set</code> і <code>delete</code>.</li> <li>Методи класів (<code>@classmethod</code>) та статичні методи (<code>@staticmethod</code>) є дескрипторами.</li> <li>Функції реалізують метод <code>__get__</code>, тому вони можуть працювати як методи, коли визначені всередині класу.</li> <li><code>__slots__</code> використовує дескриптори для оптимізації пам'яті.</li> </ul> <p>Важливо - дескриптори працюють лише тоді, коли використовуються як змінні класу. Якщо їх поставити в інстанс, вони не мають ефекту.</p> <p>Стандартна поведінка при доступі до атрибутів – отримання, встановлення та видалення атрибута зі словника об'єкта. Наприклад, <code>a.x</code> має такий ланцюжок пошуку атрибуту: <code>a.__dict__['x']</code>, потім у <code>type(a).__dict__['x']</code>, і далі у базових класах <code>type(a)</code>. Якщо шукане значення є об'єктом, що визначає один із методів дескриптора, тоді Python може замінити поведінку за замовчуванням і замість цього викликати метод дескриптора. Де це відбувається в ланцюжку пріоритетів, залежить від того, які методи дескриптора були визначені.</p> <p>Тобто у випадку дескрипторів, коли об'єкт визначено як атрибут класу (а він є дескриптором), коли клієнт запитує цей атрибут, замість отримання самого об’єкта (поведінка за замовчуванням), отримуємо результат виклику магічного методу <code>__get__</code>.</p> <p>Є два види дескрипторів - дескриптор даних - дескриптор не даних</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=k>class</span><span class=w> </span><span class=nc>DescriptorExample</span><span class=p>:</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__get__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>owner</span><span class=p>):</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>        <span class=k>return</span> <span class=n>instance</span><span class=o>.</span><span class=n>_value</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Value must be an integer.&quot;</span><span class=p>)</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>        <span class=n>instance</span><span class=o>.</span><span class=n>_value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>    <span class=n>value</span> <span class=o>=</span> <span class=n>DescriptorExample</span><span class=p>()</span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=n>obj</span> <span class=o>=</span> <span class=n>MyClass</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-30-16><a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>  <span class=c1># 42</span>
</span><span id=__span-30-17><a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=n>obj</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=mi>100</span>
</span><span id=__span-30-18><a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>  <span class=c1># 100</span>
</span><span id=__span-30-19><a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=n>obj</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=s2>&quot;string&quot;</span>  <span class=c1># throws ValueError</span>
</span></code></pre></div> <p>Дескриптори слід використовувати в тих випадках, коли потрібно визначити внутрішній API, тобто певний код, який буде використовуватися клієнтами. Дескриптори більше орієнтована на проектування бібліотек і фреймворків, а не на одноразові рішення. В загальному, дескриптори краще не використовувати для бізнес-логіки, а радше логіку, яка реалізує технічну функціональність для використання іншими компонентами, що містять бізнес-логіку.</p> <p><em>Links</em></p> <ul> <li><a href=https://docs.python.org/uk/3/howto/descriptor.html#id2>Дескриптор Інструкції - python.org</a></li> <li><a href=https://webdevblog.ru/chto-takoe-deskriptory-i-ih-ispolzovanie-v-python-3-6/ >https://webdevblog.ru/chto-takoe-deskriptory-i-ih-ispolzovanie-v-python-3-6/</a></li> <li><a href=https://habr.com/ru/articles/123216/ >Ще трохи про дескриптори у Python</a></li> <li>Getting More Out of Our Objects with Descriptors - Clean code in Python, Mariano Anaya.</li> </ul> <h4 id=_11>Види дескрипторів<a class=headerlink href=#_11 title="Permanent link">⚑</a></h4> <p>Є два види дескрипторів - дескриптор даних - дескриптор не даних</p> <p>Якщо об’єкт визначає <code>__set__()</code> або <code>__delete__()</code>, він вважається дескриптором даних. Дескриптори, які визначають лише <code>__get__()</code>, називаються дескрипторами не даних (вони часто використовуються для методів, але можливі й інші способи використання).</p> <p>Функції в Python являються дескрипторами (дескрипторами не даних) - так як реалізовують <code>__get__()</code></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=o>&gt;&gt;&gt;</span> <span class=k>def</span><span class=w> </span><span class=nf>foo</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>  
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=o>...</span>   <span class=k>return</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span>  
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=o>...</span>  
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=o>&gt;&gt;&gt;</span> <span class=s1>&#39;__get__&#39;</span> <span class=ow>in</span> <span class=nb>dir</span><span class=p>(</span><span class=n>foo</span><span class=p>)</span>  
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=kc>True</span>
</span></code></pre></div> <p>Дескриптори даних і не даних відрізняються тим, як обчислюються перевизначення щодо записів у словнику екземпляра. Якщо в словнику екземпляра є запис із таким самим іменем, як і дескриптор даних, дескриптор даних має пріоритет. Якщо в словнику екземпляра є запис із таким же ім’ям, що й дескриптор не даних, пріоритет має словниковий запис.</p> <p>Щоб створити дескриптор даних лише для читання, визначте <code>__get__()</code> і <code>__set__()</code> з <code>__set__()</code>, що викликає <code>AttributeError</code> під час виклику. Щоб зробити його дескриптором даних, достатньо визначити метод <code>__set__()</code>, що викликає винятки.</p> <h4 id=_12>Методи дескрипторів<a class=headerlink href=#_12 title="Permanent link">⚑</a></h4> <p>Методи дескрипторів – це спеціальні методи класу, які дозволяють контролювати доступ до атрибутів об'єкту через механізм дескрипторів. Дескриптори використовуються в Python для реалізації властивостей (<code>property</code>), в розробці фреймворків.</p> <ul> <li><code>__get__(self, instance, owner)</code> – викликається під час доступу до атрибуту.<ul> <li>Перший параметр, <code>instance</code>, посилається на об'єкт, з якого викликається дескриптор.</li> <li>Параметр <code>owner</code> є посиланням на клас цього екземпляру. Хоча клас можна взяти безпосередньо з екземпляру (<code>owner = instance.__class__</code>), можлива ситуація, коли дескриптор викликається з класу, а не з екземпляру. Відповідно, тоді значення екземпляра є <code>None</code>, але іноді треба виконати деяку обробку і в цьому випадку.</li> <li>Загалом, якщо не потрібно спеціально працювати з параметром <code>owner</code>, найпоширеніший підхід — просто повернути сам дескриптор, коли <code>instance</code> дорівнює <code>None</code>. Це пояснюється тим, що коли користувачі викликають дескриптор із класу, вони, ймовірно, очікують отримати сам дескриптор, що є логічним. Але, звичайно, це дійсно залежить від конкретної ситуації.</li> </ul> </li> <li><code>__set__(self, instance, value)</code> – викликається при встановленні значення атрибута - <code>client.descriptor = "value"</code>.<ul> <li>Якщо <code>client.descriptor</code> не реалізує <code>__set__()</code>, тоді <code>value</code> повністю замінить дескриптор.</li> <li>Те, що зазвичай розміщується у властивостях <code>@property</code>, можна абстрагувати в дескриптор і використовувати багаторазово. У цьому випадку метод <code>__set__()</code> робить те, що робить <code>@property.setter</code>.</li> <li>В методі <code>__set__</code> потрібно звертатись безпосередньо до атрибута <code>__dict__</code> екземпляра.</li> <li>Не можна використовувати <code>setattr()</code> або вираз присвоєння безпосередньо на дескрипторі всередині методу <code>__set__</code>, оскільки це викличе нескінченну рекурсію. Метод (<code>__set__</code>) викликається, коли щось призначається атрибуту, який є дескриптором. Тому, використання <code>setattr()</code> знову викличе цей дескриптор, що, у свою чергу, викличе його знову, і так далі. Це призведе до нескінченної рекурсії.</li> </ul> </li> <li><code>__delete__(self, instance)</code> – викликається під час видалення атрибута - <code>del client.descriptor</code>.</li> <li><code>__set_name__(self, owner, name)</code> – викликається один раз під час створення класу, що використовує дескриптор. Дозволяє дескрипторам дізнатися ім'я атрибута, до якого вони прив'язані в класі. Доданий в Python 3.6.<ul> <li>Ця назва атрибута використовується для читання з та запису до <code>__dict__</code> у методах <code>__get__</code> та <code>__set__</code>, відповідно.</li> <li>До версії Python 3.6 дескриптор не міг автоматично отримати цю назву, тому найбільш загальний підхід полягав у тому, щоб просто передавати її явно при ініціалізації об'єкта. Це вимагало дублювати назву щоразу, коли потрібно було використати дескриптор для нового атрибута.</li> </ul> </li> </ul> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=k>class</span><span class=w> </span><span class=nc>PositiveNumber</span><span class=p>:</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__get__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>owner</span><span class=p>):</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>        <span class=k>return</span> <span class=n>instance</span><span class=o>.</span><span class=vm>__dict__</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>        <span class=k>if</span> <span class=n>value</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Value must be positive&quot;</span><span class=p>)</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>        <span class=n>instance</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>__set_name__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>owner</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>  <span class=c1># Store attribute name for correct instance dict access</span>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a><span class=k>class</span><span class=w> </span><span class=nc>Product</span><span class=p>:</span>
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>    <span class=n>price</span> <span class=o>=</span> <span class=n>PositiveNumber</span><span class=p>()</span>
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a>
</span><span id=__span-32-16><a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>price</span><span class=p>):</span>
</span><span id=__span-32-17><a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a>        <span class=bp>self</span><span class=o>.</span><span class=n>price</span> <span class=o>=</span> <span class=n>price</span>  <span class=c1># Calls __set__ method of the descriptor</span>
</span><span id=__span-32-18><a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a>
</span><span id=__span-32-19><a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a><span class=n>product</span> <span class=o>=</span> <span class=n>Product</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-32-20><a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a><span class=nb>print</span><span class=p>(</span><span class=n>product</span><span class=o>.</span><span class=n>price</span><span class=p>)</span>  <span class=c1># Calls __get__ method</span>
</span><span id=__span-32-21><a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a>
</span><span id=__span-32-22><a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a><span class=n>product</span><span class=o>.</span><span class=n>price</span> <span class=o>=</span> <span class=o>-</span><span class=mi>50</span>  <span class=c1># Raises ValueError</span>
</span></code></pre></div> <h4 id=_13>Проблеми, які можуть виникнути з дескрипторами<a class=headerlink href=#_13 title="Permanent link">⚑</a></h4> <ul> <li>Дескриптори можуть викликати нескінченну рекурсію. Наприклад, при використанні <code>setattr()</code> або прямого доступу до атрибутів.</li> </ul> <div class="language-python highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=k>class</span><span class=w> </span><span class=nc>Descriptor</span><span class=p>:</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>        <span class=nb>setattr</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>  <span class=c1># Using setattr here causes infinite recursion</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>    <span class=n>attr</span> <span class=o>=</span> <span class=n>Descriptor</span><span class=p>()</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=n>obj</span> <span class=o>=</span> <span class=n>MyClass</span><span class=p>()</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=n>obj</span><span class=o>.</span><span class=n>attr</span> <span class=o>=</span> <span class=mi>42</span>  <span class=c1># This will raise a RecursionError</span>
</span></code></pre></div> <p>Щоб уникнути цієї проблеми, варто напряму звертатись до <code>__dict__</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>class</span><span class=w> </span><span class=nc>Descriptor</span><span class=p>:</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>        <span class=n>instance</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>  <span class=c1># Directly accessing __dict__ avoids recursion</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=k>class</span><span class=w> </span><span class=nc>MyClass</span><span class=p>:</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>    <span class=n>attr</span> <span class=o>=</span> <span class=n>Descriptor</span><span class=p>()</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=n>obj</span> <span class=o>=</span> <span class=n>MyClass</span><span class=p>()</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=n>obj</span><span class=o>.</span><span class=n>attr</span> <span class=o>=</span> <span class=mi>42</span>  <span class=c1># Works correctly</span>
</span></code></pre></div> <ul> <li>У випадках, коли дескриптор працює з атрибутами екземпляра через <code>__dict__</code>, можуть виникати конфлікти з іншими механізмами, які змінюють або контролюють доступ до атрибутів об'єкта.</li> <li> <p>Якщо дескриптор записує значення напряму у <code>__dict__</code> екземпляра, це може обійти контроль, передбачений у методах <code>__set__</code> або <code>__delete__</code>.</p> </li> <li> <p>Проблема спільного стану. Дескриптори повинні бути встановлені як атрибути класу, щоб працювати. Проблема з атрибутами класу полягає в тому, що вони спільні для всіх екземплярів цього класу. Дескриптори не є винятком, тому якщо спробувати зберігати дані в об'єкті дескриптора, потрібно пам'ятати, що всі вони матимуть доступ до одного й того ж значення.</p> </li> </ul> <div class="language-python highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=k>class</span><span class=w> </span><span class=nc>SharedDataDescriptor</span><span class=p>:</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>initial_value</span><span class=p>):</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>initial_value</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__get__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>owner</span><span class=p>):</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>        <span class=k>if</span> <span class=n>instance</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>            <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a>
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-35-12><a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a>
</span><span id=__span-35-13><a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a><span class=k>class</span><span class=w> </span><span class=nc>ClientClass</span><span class=p>:</span>
</span><span id=__span-35-14><a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a>    <span class=n>descriptor</span> <span class=o>=</span> <span class=n>SharedDataDescriptor</span><span class=p>(</span><span class=s2>&quot;first value&quot;</span><span class=p>)</span>
</span><span id=__span-35-15><a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a>
</span><span id=__span-35-16><a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client1</span> <span class=o>=</span> <span class=n>ClientClass</span><span class=p>()</span>
</span><span id=__span-35-17><a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client1</span><span class=o>.</span><span class=n>descriptor</span>
</span><span id=__span-35-18><a id=__codelineno-35-18 name=__codelineno-35-18 href=#__codelineno-35-18></a><span class=s1>&#39;first value&#39;</span>
</span><span id=__span-35-19><a id=__codelineno-35-19 name=__codelineno-35-19 href=#__codelineno-35-19></a>
</span><span id=__span-35-20><a id=__codelineno-35-20 name=__codelineno-35-20 href=#__codelineno-35-20></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client2</span> <span class=o>=</span> <span class=n>ClientClass</span><span class=p>()</span>
</span><span id=__span-35-21><a id=__codelineno-35-21 name=__codelineno-35-21 href=#__codelineno-35-21></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client2</span><span class=o>.</span><span class=n>descriptor</span>
</span><span id=__span-35-22><a id=__codelineno-35-22 name=__codelineno-35-22 href=#__codelineno-35-22></a><span class=s1>&#39;first value&#39;</span>
</span><span id=__span-35-23><a id=__codelineno-35-23 name=__codelineno-35-23 href=#__codelineno-35-23></a>
</span><span id=__span-35-24><a id=__codelineno-35-24 name=__codelineno-35-24 href=#__codelineno-35-24></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client2</span><span class=o>.</span><span class=n>descriptor</span> <span class=o>=</span> <span class=s2>&quot;value for client 2&quot;</span>
</span><span id=__span-35-25><a id=__codelineno-35-25 name=__codelineno-35-25 href=#__codelineno-35-25></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client2</span><span class=o>.</span><span class=n>descriptor</span>
</span><span id=__span-35-26><a id=__codelineno-35-26 name=__codelineno-35-26 href=#__codelineno-35-26></a><span class=s1>&#39;value for client 2&#39;</span>
</span><span id=__span-35-27><a id=__codelineno-35-27 name=__codelineno-35-27 href=#__codelineno-35-27></a>
</span><span id=__span-35-28><a id=__codelineno-35-28 name=__codelineno-35-28 href=#__codelineno-35-28></a><span class=o>&gt;&gt;&gt;</span> <span class=n>client1</span><span class=o>.</span><span class=n>descriptor</span>
</span><span id=__span-35-29><a id=__codelineno-35-29 name=__codelineno-35-29 href=#__codelineno-35-29></a><span class=s1>&#39;value for client 2&#39;</span>
</span></code></pre></div> <ul> <li>Якщо дескриптор зберігає посилання на екземпляр класу, це може перешкоджати його коректному видаленню збирачем сміття. Наприклад коли потрібно, щоб об'єкт дескриптора самостійно відстежував значення для кожного екземпляра у внутрішньому відображенні (mapping) та повертати значення з цього відображення. Однак, оскільки клас-клієнт має посилання на дескриптор, а тепер дескриптор буде зберігати посилання на об'єкти, які його використовують, це створить циклічні залежності, і, як результат, ці об'єкти ніколи не будуть знищені збирачем сміття, оскільки вони посилаються один на одного. Щоб вирішити цю проблему, словник повинен бути слабким, як це визначено в модулі <code>weakref</code>. Це вирішує проблеми, але має деякі аспекти, які варто врахувати - об'єкти більше не зберігають свої атрибути - замість цього їх зберігає дескриптор (наприклад, виклик vars(client) не поверне повні дані). Та це вимагає, щоб об'єкти були хешованими.</li> </ul> <div class="language-python highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=kn>from</span><span class=w> </span><span class=nn>weakref</span><span class=w> </span><span class=kn>import</span> <span class=n>WeakKeyDictionary</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=k>class</span><span class=w> </span><span class=nc>DescriptorClass</span><span class=p>:</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>initial_value</span><span class=p>):</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>initial_value</span>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mapping</span> <span class=o>=</span> <span class=n>WeakKeyDictionary</span><span class=p>()</span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a>
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>    <span class=k>def</span><span class=w> </span><span class=fm>__get__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>owner</span><span class=p>):</span>
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a>        <span class=k>if</span> <span class=n>instance</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>            <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-36-11><a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>mapping</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-36-12><a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>
</span><span id=__span-36-13><a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a>    <span class=k>def</span><span class=w> </span><span class=fm>__set__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>instance</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-36-14><a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mapping</span><span class=p>[</span><span class=n>instance</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="July 15, 2025 11:36:11 UTC"><span class=timeago datetime=2025-07-15T11:36:11+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="July 15, 2025 11:36:11 UTC">2025-07-15</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../iterator_and_generator/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Iterator and Generator"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Iterator and Generator </div> </div> </a> <a href=../metaclass/ class="md-footer__link md-footer__link--next" aria-label="Next: Metaclass"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Metaclass </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/tavor118 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.footer", "navigation.instant", "navigation.top", "content.code.annotate", "content.code.copy", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56ea9cef.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> </body> </html>